<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="这是木杉的个人博客"><title>MMNote开发笔记 | 木杉的博客</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">MMNote开发笔记</h1><a id="logo" href="/.">木杉的博客</a><p class="description">要么精通，要么死</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">MMNote开发笔记</h1><div class="post-meta">Dec 21, 2016<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><a data-disqus-identifier="2016/12/21/project/mmnote/MMNote开发笔记/" href="/2016/12/21/project/mmnote/MMNote开发笔记/#disqus_thread" class="disqus-comment-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#值得学习的教程"><span class="toc-number">1.</span> <span class="toc-text">值得学习的教程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#值得学习的APP"><span class="toc-number">2.</span> <span class="toc-text">值得学习的APP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#开发工具"><span class="toc-number">3.</span> <span class="toc-text">开发工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#打包工具"><span class="toc-number">4.</span> <span class="toc-text">打包工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#开发手记"><span class="toc-number">5.</span> <span class="toc-text">开发手记</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2016年12月22日-React动画"><span class="toc-number">5.1.</span> <span class="toc-text">2016年12月22日 React动画</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2016年12月25日-树控件-Webpack自动刷新-区分配置文件"><span class="toc-number">5.2.</span> <span class="toc-text">2016年12月25日 树控件 Webpack自动刷新 区分配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2016年12月30-31日-新建工程"><span class="toc-number">5.3.</span> <span class="toc-text">2016年12月30-31日 新建工程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年01月01日-星期日-树形控件与真实目录对应"><span class="toc-number">5.4.</span> <span class="toc-text">2017年01月01日 星期日 树形控件与真实目录对应</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年01月02日-星期一-树形控件滚动条样式"><span class="toc-number">5.5.</span> <span class="toc-text">2017年01月02日 星期一 树形控件滚动条样式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年01月04日-星期三-IPC"><span class="toc-number">5.6.</span> <span class="toc-text">2017年01月04日 星期三 IPC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年01月07日-星期六-快捷键-命令框架"><span class="toc-number">5.7.</span> <span class="toc-text">2017年01月07日 星期六 快捷键 命令框架</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年01月08日-星期日-CodeMirror插件机制"><span class="toc-number">5.8.</span> <span class="toc-text">2017年01月08日 星期日 CodeMirror插件机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年01月14日-星期六-完善项目搭建"><span class="toc-number">5.9.</span> <span class="toc-text">2017年01月14日 星期六 完善项目搭建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年01月15日-星期日-工作流升级-gulp-electron-connect-mocha"><span class="toc-number">5.10.</span> <span class="toc-text">2017年01月15日 星期日 工作流升级 gulp electron-connect mocha</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年01月18日-星期三-更新代码结构-main-render-test"><span class="toc-number">5.11.</span> <span class="toc-text">2017年01月18日 星期三 更新代码结构 main render test</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年01月19日-星期四-在electron中安装调试插件"><span class="toc-number">5.12.</span> <span class="toc-text">2017年01月19日 星期四 在electron中安装调试插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年01月23日-星期一-react-redux"><span class="toc-number">5.13.</span> <span class="toc-text">2017年01月23日 星期一 react-redux</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年01月24日-星期二-immutable-js"><span class="toc-number">5.14.</span> <span class="toc-text">2017年01月24日 星期二 immutable.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年01月26日-星期四-异步action-使用没有类型定义的包"><span class="toc-number">5.15.</span> <span class="toc-text">2017年01月26日 星期四 异步action 使用没有类型定义的包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年01月29日-星期日"><span class="toc-number">5.16.</span> <span class="toc-text">2017年01月29日 星期日</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年02月03日-星期五-粘贴图片"><span class="toc-number">5.17.</span> <span class="toc-text">2017年02月03日 星期五 粘贴图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年02月05日-星期日"><span class="toc-number">5.18.</span> <span class="toc-text">2017年02月05日 星期日</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年02月08日-星期三"><span class="toc-number">5.19.</span> <span class="toc-text">2017年02月08日 星期三</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年02月09日-星期四-列表补全-标题大小区分"><span class="toc-number">5.20.</span> <span class="toc-text">2017年02月09日 星期四 列表补全 标题大小区分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年02月10日-星期六-打包-编辑器卡顿排查"><span class="toc-number">5.21.</span> <span class="toc-text">2017年02月10日 星期六 打包 编辑器卡顿排查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年02月12日-星期日-了解Draft-js-File-URI-state思考"><span class="toc-number">5.22.</span> <span class="toc-text">2017年02月12日 星期日 了解Draft.js File URI state思考</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年02月13日-星期一"><span class="toc-number">5.23.</span> <span class="toc-text">2017年02月13日 星期一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年02月18日-星期六-tree-view结合Redux-软链接处理-fs-promise"><span class="toc-number">5.24.</span> <span class="toc-text">2017年02月18日 星期六 tree-view结合Redux 软链接处理 fs-promise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年02月19日-星期日"><span class="toc-number">5.25.</span> <span class="toc-text">2017年02月19日 星期日</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年02月20日-星期一"><span class="toc-number">5.26.</span> <span class="toc-text">2017年02月20日 星期一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年02月22日-星期三"><span class="toc-number">5.27.</span> <span class="toc-text">2017年02月22日 星期三</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2017年02月26日-星期日-初步整合kityminder-学习mobx"><span class="toc-number">5.28.</span> <span class="toc-text">2017年02月26日 星期日 初步整合kityminder 学习mobx</span></a></li></ol></li></ol></div></div><div class="post-content"><a id="more"></a>
<h2 id="值得学习的教程"><a href="#值得学习的教程" class="headerlink" title="值得学习的教程"></a>值得学习的教程</h2><ul>
<li><a href="https://zhuanlan.zhihu.com/p/20225295?columnSlug=FrontendMagazine" target="_blank" rel="noopener">使用 Electron 构建桌面应用 - 前端外刊评论 - 知乎专栏</a></li>
</ul>
<h2 id="值得学习的APP"><a href="#值得学习的APP" class="headerlink" title="值得学习的APP"></a>值得学习的APP</h2><ul>
<li><a href="https://github.com/brrd/Abricotine" target="_blank" rel="noopener">brrd/Abricotine: Markdown editor with inline preview</a></li>
<li><a href="https://github.com/Automattic/simplenote-electron" target="_blank" rel="noopener">Automattic/simplenote-electron: A Simplenote React app packaged in Electron</a></li>
<li><a href="https://github.com/AnotherNote/anote" target="_blank" rel="noopener">AnotherNote/anote: another markdown note (inspired by evernote)</a></li>
<li><a href="https://github.com/amitmerchant1990/electron-markdownify" target="_blank" rel="noopener">amitmerchant1990/electron-markdownify: A minimal Markdown editor desktop app based on Electron</a></li>
</ul>
<h2 id="开发工具"><a href="#开发工具" class="headerlink" title="开发工具"></a>开发工具</h2><h2 id="打包工具"><a href="#打包工具" class="headerlink" title="打包工具"></a>打包工具</h2><ul>
<li><a href="https://github.com/electron/electron/blob/master/docs/tutorial/application-distribution.md" target="_blank" rel="noopener">electron/application-distribution.md at master · electron/electron</a></li>
<li><a href="https://github.com/electron-userland/electron-builder" target="_blank" rel="noopener">electron-userland/electron-builder: A complete solution to package and build a ready for distribution Electron app with “auto update” support out of the box</a></li>
<li><a href="https://github.com/electron-userland/electron-packager" target="_blank" rel="noopener">electron-userland/electron-packager: Package and distribute your Electron app with OS-specific bundles (.app, .exe etc) via JS or CLI</a></li>
</ul>
<h2 id="开发手记"><a href="#开发手记" class="headerlink" title="开发手记"></a>开发手记</h2><h3 id="2016年12月22日-React动画"><a href="#2016年12月22日-React动画" class="headerlink" title="2016年12月22日 React动画"></a>2016年12月22日 React动画</h3><p>这两天从react-treebeard这个插件看起，了解其中使用到的Radium和velocity-react。因为这个插件在限制宽度的情况下，显示有些问题，所以要么进行修改，要么得自己写一个。</p>
<p>关于<strong>树节点动画</strong>，这个插件在展开节点时，会旋转左侧箭头(svg画的)，同时会动画展开其子列表。这个还不错。我一直以为所有的编辑器都有这个动画的，以为很基础嘛，没想到观察了一下,每个编辑器表现都不一样：</p>
<ul>
<li>sublime: 箭头无动画，展开有动画</li>
<li>vscode: 都无动画</li>
<li>atom: 都无动画</li>
<li>TextMate: 箭头无动画，展开有动画</li>
</ul>
<p>没想到，这两个动画竟然没有做全的。其中，看了vscode和atom的html，其箭头都是使用::before伪元素做到的，所以不支持动画吧。(2016年12月24日 补充：看了下ant design的树控件，使用伪元素，也是能做到动画的)</p>
<p>再说说<strong>在有限空间内，各个编辑器是如何展示的条目</strong>的：</p>
<ul>
<li>sublime: 不会压缩显示，可以横向滚动</li>
<li>vscode: 压缩显示，条目名称最后压缩为省略号</li>
<li>atom: 不会压缩显示，可以横向滚动</li>
<li>TextMate: 压缩显示，条目名称中间压缩为省略号</li>
</ul>
<p>我个人是倾向于不压缩显示的。</p>
<h3 id="2016年12月25日-树控件-Webpack自动刷新-区分配置文件"><a href="#2016年12月25日-树控件-Webpack自动刷新-区分配置文件" class="headerlink" title="2016年12月25日 树控件 Webpack自动刷新 区分配置文件"></a>2016年12月25日 树控件 Webpack自动刷新 区分配置文件</h3><p>今天早上竟然失眠，6点多就起来了，继续写树控件，现在有点样子了，整合了web font和max-content：</p>
<p><img src="/img/mmnote/2016-12-25.png" alt=""></p>
<p>主要是解决了react-treebread空间的小空间换行问题和宽度不对问题。CSS的width是关键，具体参考了：<a href="http://www.zhangxinxu.com/wordpress/2016/05/css3-width-max-contnet-min-content-fit-content/" target="_blank" rel="noopener">理解CSS3 max/min-content及fit-content等width值</a>.</p>
<p>我一遍做一边参考atom和vscode（基于HTML5技术就是好啊，随时随地可以参考）。发现atom是常规做法，也就是整个树是一个ol或者ul，然后一个一个递归渲染出。对于没有打开的子目录是不会渲染到DOM上的。</p>
<p>但是vscode却不是。其目录树完全是一个div list。层级关系的表示都是在inline style中设置padding left做到的，应该是在代码中算出来的。而且，最最重要的一点，他没有渲染出整个已经打开的目录树，而是只渲染了但求可见范围内的节点！！！<strong>这是多么机智的优化啊！！！</strong></p>
<p>这样就算你打开了N多文件的目录，页面也不会卡顿，因为他只渲染当前可以显示的这么十几条数据。学习了。</p>
<p>晚上：<br>学习了如何使用webpack的开发服务器，以及如何区分配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;hot-server&quot;: &quot;cross-env NODE_ENV=development node --max_old_space_size=2096 -r babel-register server.js&quot;,</span><br></pre></td></tr></table></figure>
<p>这是electron-react-boilerplate项目的一个npm script。通过cross-env这个包来指定环境变量，区分开发环境还是正式环境，然后在代码中判断该变量走不通配置等：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if (process.env.NODE_ENV === &apos;production&apos;) &#123;</span><br><span class="line">  module.exports = require(&apos;./configureStore.production&apos;); // eslint-disable-line global-require</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  module.exports = require(&apos;./configureStore.development&apos;); // eslint-disable-line global-require</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看了下<a href="http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_three_react-redux.html" target="_blank" rel="noopener">Redux 入门教程（三）：React-Redux 的用法 - 阮一峰的网络日志</a>，不是很懂。。。感觉结合Redux还是比较麻烦的，概念比较多。</p>
<p>这两天对整个React应用开发和CSS都加深了认识，但是完全不够啊，还是没有到达能够“开工”的标准。。。</p>
<h3 id="2016年12月30-31日-新建工程"><a href="#2016年12月30-31日-新建工程" class="headerlink" title="2016年12月30-31日 新建工程"></a>2016年12月30-31日 新建工程</h3><p>占时先不学习Redux了，直接开始写吧，新建工程走起。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mkdir mmnote</span><br><span class="line">cd mmnote</span><br><span class="line">npm init</span><br><span class="line"></span><br><span class="line">npm install --save-dev webpack typescript awesome-typescript-loader source-map-loader  css-loader style-loader webpack-dev-server less less-loader</span><br><span class="line">npm install --save react react-dom @types/react @types/react-dom lodash electron normalize.css</span><br><span class="line">npm install --save codemirror @types/codemirror react-split-pane @types/react-split-pane</span><br><span class="line"></span><br><span class="line">// fs-extra @types/fs-extra</span><br></pre></td></tr></table></figure>
<p>//TODO 搭建项目笔记，记录目前搭建的步骤，随着项目不断推进，不断学习后更新。</p>
<p><img src="/img/mmnote-2016-12-31-tree-demo.png" alt=""></p>
<h3 id="2017年01月01日-星期日-树形控件与真实目录对应"><a href="#2017年01月01日-星期日-树形控件与真实目录对应" class="headerlink" title="2017年01月01日 星期日 树形控件与真实目录对应"></a>2017年01月01日 星期日 树形控件与真实目录对应</h3><p>今天雾霾好大，去奥林匹克公园逛了逛。今天争取吧目录树和真是目录对应上。</p>
<p>第一个问题是node.js中如何遍历目录树。</p>
<p>fs-extra这个包是fs包的扩展，其中包括了遍历目录树。</p>
<p>但是呢，依赖这种扩展，对应的ts声明又太久了，现在还懒得学习如何编写声明。还是看看对应的walk是如何实现的吧。</p>
<p><a href="https://github.com/jprichardson/node-klaw" target="_blank" rel="noopener">node-klaw: A Node.js file system walker with a Readable stream interface</a></p>
<p>代码很简单，就一个文件，但是涉及的知识点很多。</p>
<p>我学着他的代码写了一个例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">var Readable = require(&quot;stream&quot;).Readable;</span><br><span class="line">var util = require(&quot;util&quot;);</span><br><span class="line"></span><br><span class="line">function Walker() &#123;</span><br><span class="line">    var options = &#123;</span><br><span class="line">        objectMode: true</span><br><span class="line">    &#125;;</span><br><span class="line">    this.result = [];</span><br><span class="line">    Readable.call(this, options);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Walker.prototype._read = function() &#123;</span><br><span class="line">    if (this.result.length == 3) &#123;</span><br><span class="line">        return this.push(null);</span><br><span class="line">    &#125;</span><br><span class="line">    this.result.push(&quot;hello&quot;);</span><br><span class="line">    this.push(&quot;hello&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">util.inherits(Walker, Readable)</span><br><span class="line"></span><br><span class="line">var walk = new Walker();</span><br><span class="line">walk.on(&quot;data&quot;, function(data) &#123;</span><br><span class="line">    console.log(data);</span><br><span class="line">&#125;);</span><br><span class="line">walk.on(&quot;end&quot;, function(data) &#123;</span><br><span class="line">    console.log(&quot;end&quot;);</span><br><span class="line">    console.log(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这是自定义Readable的最简单的一个例子了。</p>
<ul>
<li>使用nodejs自带的util.inherits()来实现继承</li>
<li>继承Readable一定要实现_read()方法，其中使用this.push()来添加这次读取的内容，使用this.push(null)表示读取完毕</li>
</ul>
<p>至于如何整合到项目中，目前觉得先使用fs.readdir()来实现即可。</p>
<p>ts的interface可以有默认值么？ – 不能</p>
<p>今日进展：</p>
<p>![]（/img/mmnote-2017-01-02-tree-demo.png)</p>
<h3 id="2017年01月02日-星期一-树形控件滚动条样式"><a href="#2017年01月02日-星期一-树形控件滚动条样式" class="headerlink" title="2017年01月02日 星期一 树形控件滚动条样式"></a>2017年01月02日 星期一 树形控件滚动条样式</h3><p>看Atom的滚动条样式发现css的选择器中出现了<code>/deep/</code>这种写法。</p>
<p><a href="http://stackoverflow.com/questions/25609678/what-do-deep-and-shadow-mean-in-a-css-selector/25609679#25609679" target="_blank" rel="noopener">html5 - What do /deep/ and ::shadow mean in a CSS selector? - Stack Overflow</a></p>
<p>看来是为了能够修饰shadow dom内部而生的选择器。</p>
<hr>
<p>滚动条样式目前看来没有同意写法，还好我们只用写webkit的：</p>
<p><a href="http://www.lyblog.net/detail/314.html" target="_blank" rel="noopener">自定义浏览器滚动条的样式，打造属于你的滚动条风格</a></p>
<p>修改了滚动条样式的效果：</p>
<p><img src="/img/mmnote-2017-01-02-tree-demo2.png" alt=""></p>
<hr>
<p>发现树控件中的选中是个麻烦事。点击一个节点，选中当前，但是需要把之前选中的取消选中，如果支持多选，就得用一个数组来保存了。</p>
<p>而且选中后的高亮也是麻烦事。vscode中因为不是数结构所以好做，但是Atom中就不容易了，需要用一个定位为absolute的before伪元素来做到。</p>
<hr>
<p>服了，javascript中竟然没有清空数组的方法。。。see <a href="http://stackoverflow.com/questions/1232040/how-do-i-empty-an-array-in-javascript" target="_blank" rel="noopener">How do I empty an array in JavaScript? - Stack Overflow</a></p>
<hr>
<p>接着就是引入code-mirror了。</p>
<p>参考项目：<a href="https://github.com/JedWatson/react-codemirror" target="_blank" rel="noopener">JedWatson/react-codemirror: Codemirror Component for React.js</a></p>
<p><strong>注意</strong> CodeMirror.fromTextArea()这个方法，会使用textarea中的内容，忽视传入的value参数。</p>
<hr>
<p>遇到一个棘手问题，codemirror和flex布局结合，导致宽度处理不对了。</p>
<p>被搞吐了，一个下午就花在codemirror的linenumber上了，搞不懂新写的例子都没问题。就是这个项目里面的有问题。</p>
<p>表现是这样的：</p>
<p><img src="../../img/mmnote-2017-01-02-codemirror-error.png" alt=""></p>
<p>右边灰色的全是line number。。。先回避这个问题吧。</p>
<p>目前的效果：</p>
<p><img src="/img/mmnote-2017-01-02-codemirror-demo.png" alt=""></p>
<p>乍看还不错😁，但是还很不完美。</p>
<hr>
<p>接下来是想实现快捷键Ctrl+S保存的功能。</p>
<p>学习<a href="https://zhuanlan.zhihu.com/p/20225295?columnSlug=FrontendMagazine" target="_blank" rel="noopener">使用 Electron 构建桌面应用 - 前端外刊评论 - 知乎专栏</a></p>
<p>其中提到了无标题栏窗口的做法，可以在mac中做出很漂亮的界面：</p>
<p><a href="http://electron.atom.io/docs/api/frameless-window/" target="_blank" rel="noopener">Frameless Window - Electron</a></p>
<p>观察了一下，发现atom是包含系统标题栏的，而vscode则是使用了<code>titleBarStyle: &#39;hidden&#39;</code>加上自定义的标题栏实现的。</p>
<p><img src="/img/mmnote-2017-01-02-atom-title-bar.png" alt=""></p>
<p><img src="/img/mmnote-2017-01-02-vacode-title-bar.png" alt=""></p>
<p>后者可以让标题栏成为主题可以定制的一部分，明显更好看了。不知道windows底下是如何表现的。</p>
<hr>
<p>ipc原来是通过on和send来交互的，用起来很简单。</p>
<p>被坑了一波。<code>var ipc = require(&#39;ipc&#39;);</code>这种写法是过时的，新的写法是：<code>const {ipcMain} = require(&#39;electron&#39;)</code></p>
<p><a href="http://electron.atom.io/docs/api/ipc-main/" target="_blank" rel="noopener">ipcMain - Electron</a></p>
<h3 id="2017年01月04日-星期三-IPC"><a href="#2017年01月04日-星期三-IPC" class="headerlink" title="2017年01月04日 星期三 IPC"></a>2017年01月04日 星期三 IPC</h3><p>遇到错误<code>Cannot find name &#39;Promise&#39;</code>，需要把typescript的target改成es1.6</p>
<p><a href="http://stackoverflow.com/questions/39116687/error-ts2304-cannot-find-name-promise" target="_blank" rel="noopener">node.js - error TS2304: Cannot find name ‘Promise’ - Stack Overflow</a></p>
<p>《electron学习笔记》，添加IPC章节。</p>
<h3 id="2017年01月07日-星期六-快捷键-命令框架"><a href="#2017年01月07日-星期六-快捷键-命令框架" class="headerlink" title="2017年01月07日 星期六 快捷键 命令框架"></a>2017年01月07日 星期六 快捷键 命令框架</h3><p>如何为程序添加快捷键呢（非全局快捷键）？</p>
<p>vscode的快捷键设置格式是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123; &quot;key&quot;: &quot;cmd+delete&quot;, &quot;command&quot;: &quot;deleteAllRight&quot;,</span><br><span class="line">                       &quot;when&quot;: &quot;editorTextFocus &amp;&amp; !editorReadonly&quot; &#125;,</span><br></pre></td></tr></table></figure>
<p>一个快捷键绑定了一个命令，同时when指定了快捷键生效的前提条件。条件由几个bool变量构成。</p>
<p>而一如既往，Atom的设计更为叹服：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&apos;atom-text-editor&apos;:</span><br><span class="line">  &apos;ctrl-b&apos;: &apos;typescript:go-to-declaration&apos;</span><br><span class="line"></span><br><span class="line">&apos;atom-text-editor[data-grammar=&quot;source gfm&quot;]:not([mini])&apos;:</span><br><span class="line">  &apos;tab&apos;:        &apos;markdown-folder:dwim-toggle&apos;</span><br><span class="line">  &apos;alt-c&apos;:      &apos;markdown-folder:cycle&apos;</span><br></pre></td></tr></table></figure>
<p>类似css选择器的写法，更加强大。</p>
<p>我发现好几个地方的设计都是如何，Atom的设计更加前卫。可惜代码质量没有大神来监督，导致在性能上败了。同时选型coffeescript也是个白痴选择。</p>
<hr>
<p>上面两个是王牌，最求最高可定制。而普通软件是如何做的呢？</p>
<p>electron本身使用MenuItem中的click属性来定义菜单点击后执行的代码。我看了Abricotine这款笔记软件的实现，他在菜单template中添加了几个自定义字段，比如platform，command。然后在新建菜单之前，处理一遍template，比如检查当前平台，如果不符合，就隐藏一些菜单项。然后把所有的command翻译为对应的click函数，使用其顶级Application类来执行命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 处理template中的每个item</span><br><span class="line"></span><br><span class="line">// 把command翻译为click函数，委托给sendCommand</span><br><span class="line">// sendCommand的定义是：var sendCommand = abrApp.execCommand.bind(abrApp)</span><br><span class="line">if (item.command) &#123;</span><br><span class="line">    item.click = (function (command, parameters) &#123;</span><br><span class="line">        return function () &#123; sendCommand(command, parameters); &#125;;</span><br><span class="line">    &#125;)(item.command, item.parameters);</span><br><span class="line">    item.id = item.command;</span><br><span class="line">    delete item.command;</span><br><span class="line">    delete item.parameters;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 对于菜单的状态，还可以根据配置文件来更新</span><br><span class="line">if (item.type === &quot;checkbox&quot; &amp;&amp; typeof item.checked === &quot;string&quot;) &#123;</span><br><span class="line">    item.checked = getConfig(config, item.checked);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我觉得这个设计非常值得学习。用命令来组织这些操作，也是所有编辑器的设计，这样用户也可以在命令面板中执行。</p>
<hr>
<p>Abricotine中是如何exec命令的呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">execCommand: function (command, parameters) &#123;</span><br><span class="line">    // 发送命令到当前激活的窗口</span><br><span class="line">    var win = BrowserWindow.getFocusedWindow();</span><br><span class="line">    if (win) &#123;</span><br><span class="line">        // 使用IPC发送命令</span><br><span class="line">        return win.webContents.send(&quot;command&quot;, command, parameters);</span><br><span class="line">    &#125;</span><br><span class="line">    // if no window, run a command from commands-main.js</span><br><span class="line">    if (commands &amp;&amp; commands[command]) &#123;</span><br><span class="line">        commands[command](this, parameters);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        console.error(&quot;Unknown command &apos;&quot; + command + &quot;&apos;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>答案是通过IPC发送命令带对应的window来执行。在render进程代码中，定义command列表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">var commands = &#123;</span><br><span class="line"></span><br><span class="line">    new: function(win, abrDoc, cm) &#123;</span><br><span class="line">        abrDoc.new();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    open: function(win, abrDoc, cm) &#123;</span><br><span class="line">        abrDoc.open();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 执行命令</span><br><span class="line">execCommand: function (command, parameters) &#123;</span><br><span class="line">    var win = remote.getCurrentWindow(),</span><br><span class="line">        abrDoc = this;</span><br><span class="line">    if (commands &amp;&amp; commands[command]) &#123;</span><br><span class="line">        commands[command](win, abrDoc, abrDoc.cm, parameters);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        console.error(&quot;Unknown command &apos;&quot; + command + &quot;&apos;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<hr>
<p>《electron学习笔记》，添加对话框，菜单，快捷键，shell章节。</p>
<hr>
<p>新建《Abricotine是如何整合CodeMirror的》</p>
<h3 id="2017年01月08日-星期日-CodeMirror插件机制"><a href="#2017年01月08日-星期日-CodeMirror插件机制" class="headerlink" title="2017年01月08日 星期日 CodeMirror插件机制"></a>2017年01月08日 星期日 CodeMirror插件机制</h3><p>昨天知道了Abricotine的那些“特效”是通过CodeMirror插件实现的。今天来了解一下如何写CodeMirror插件。</p>
<p>《CodeMirror使用笔记》添加“扩展CodeMirror”章节</p>
<p>《Abricotine是如何整合CodeMirror的》完善</p>
<h3 id="2017年01月14日-星期六-完善项目搭建"><a href="#2017年01月14日-星期六-完善项目搭建" class="headerlink" title="2017年01月14日 星期六 完善项目搭建"></a>2017年01月14日 星期六 完善项目搭建</h3><p>《node.js新的包管理器 - yarn》完成。</p>
<p>《使用yeoman创建项目生成器》完成。</p>
<h3 id="2017年01月15日-星期日-工作流升级-gulp-electron-connect-mocha"><a href="#2017年01月15日-星期日-工作流升级-gulp-electron-connect-mocha" class="headerlink" title="2017年01月15日 星期日 工作流升级 gulp electron-connect mocha"></a>2017年01月15日 星期日 工作流升级 gulp electron-connect mocha</h3><p>keyword： </p>
<ul>
<li>学习vscode debug设置</li>
<li>学习mocha/chai，与typescript结合</li>
<li>学习gulp，设计工作流整合</li>
<li>gulp整合webpack+electron-connect<ul>
<li>watch主进程代码，使用gulp-typescript编译主进程代码，restart electron</li>
<li>watch渲染进程代码，使用webpack-stream编译渲染进程代码，reload electron</li>
</ul>
</li>
<li>gulp生成typescript<ul>
<li>生成ts的sourcemap的配置 <a href="https://github.com/floridoo/gulp-sourcemaps#write-options" target="_blank" rel="noopener">floridoo/gulp-sourcemaps: Source map support for Gulp.js</a></li>
<li>如何使用vscode来调试 <a href="http://stackoverflow.com/questions/37477139/how-to-debug-a-gulp-task-with-vscode" target="_blank" rel="noopener">debugging - How to debug a gulp task with VSCode - Stack Overflow</a></li>
</ul>
</li>
<li>gulp test任务<ul>
<li>使用gulp-typescript编译render代码，和test代码到test-out中</li>
<li>拷贝test-res到test-out中去</li>
<li>执行测试</li>
</ul>
</li>
</ul>
<p>了解到的库：</p>
<ul>
<li>使fs等标准库支持promise：<a href="https://github.com/normalize/mz" target="_blank" rel="noopener">normalize/mz: modernize node.js to current ECMAScript standards</a></li>
</ul>
<p>学习到的语法：</p>
<ul>
<li>ts不支持重载</li>
<li>interface不支持默认值</li>
</ul>
<h3 id="2017年01月18日-星期三-更新代码结构-main-render-test"><a href="#2017年01月18日-星期三-更新代码结构-main-render-test" class="headerlink" title="2017年01月18日 星期三 更新代码结构 main render test"></a>2017年01月18日 星期三 更新代码结构 main render test</h3><p>更新了目录结构，代码都放在src下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── src 代码目录</span><br><span class="line">│   ├── common 公用代码</span><br><span class="line">│   ├── main 主进程代码</span><br><span class="line">│   │   ├── res 资源文件</span><br><span class="line">│   │   ├── application.ts</span><br><span class="line">│   │   ├── main.ts 入口文件</span><br><span class="line">│   │   ├── menu.ts</span><br><span class="line">│   │   └── window.ts</span><br><span class="line">│   └── render 渲染进程代码</span><br><span class="line">│       ├── component react组件</span><br><span class="line">│       ├── res 资源文件</span><br><span class="line">│       ├── service</span><br><span class="line">│       ├── util</span><br><span class="line">│       ├── index.less</span><br><span class="line">│       └── index.tsx</span><br><span class="line">├── test 测试代码目录</span><br><span class="line">│   ├── res 测试资源目录</span><br><span class="line">│   └── tree-service.spec.ts </span><br><span class="line">├── gulpfile.js</span><br><span class="line">├── package.json</span><br><span class="line">├── tsconfig.main.json 主进程用的tsconfig</span><br><span class="line">├── tsconfig.render.json 渲染进程用的tsconfig</span><br><span class="line">├── tsconfig.test.json 测试代码用的tsconfig</span><br><span class="line">├── webpack.config.js</span><br><span class="line">└── yarn.lock</span><br></pre></td></tr></table></figure>
<p>项目结构比较复杂了，有三个部分的代码：main，render，test。三个部分各有交集，但是在生成上的规则又有些不一样。</p>
<ul>
<li>main：使用gulp-typescript编译main/common的代码，并输出到dist</li>
<li>render：使用webpack-stream打包render/common的代码，并输出到dist</li>
<li>test：使用gulp-typescript编译main/render/common的代码，并输出到test-out，执行测试</li>
</ul>
<p>目前gulp的完美写法为：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mainCode = [<span class="string">'src/main/**/*.ts*'</span>, <span class="string">'src/common/**/*.ts*'</span>];</span><br><span class="line"><span class="keyword">const</span> renderCode = [<span class="string">'src/render/**/*.ts*'</span>, <span class="string">'src/common/**/*.ts*'</span>];</span><br><span class="line"><span class="keyword">const</span> webpackConfig = <span class="built_in">require</span>(<span class="string">'./webpack.config.js'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'main'</span>, [], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(mainCode, &#123; <span class="attr">base</span>: <span class="string">"./"</span> &#125;)</span><br><span class="line">        .pipe(tsMainProject())</span><br><span class="line">        .js.pipe(gulp.dest(<span class="string">"dist"</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'main-w'</span>, [<span class="string">'main'</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.watch(mainCode, [<span class="string">'main'</span>]);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">webpackTask</span>(<span class="params">watch</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'src/render/index.tsx'</span>)</span><br><span class="line">        .pipe(webpack(_.merge(webpackConfig, &#123; <span class="attr">watch</span>: watch &#125;), <span class="literal">null</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, stat</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"webpack error: "</span>, err);</span><br><span class="line">        &#125;).on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// fix issue https://github.com/shama/webpack-stream/issues/34</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"webpack task error:"</span>, err);</span><br><span class="line">            <span class="comment">// this.emit('end');</span></span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe(gulp.dest(<span class="string">"./dist"</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'webpack'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> webpackTask(<span class="literal">false</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'webpack-w'</span>, [<span class="string">'webpack'</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    webpackTask(<span class="literal">true</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'all-w'</span>, [<span class="string">'main-w'</span>, <span class="string">'webpack-w'</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>运行<code>gulp all-w</code>就能自动监视编译main和render的代码，简直爽。</p>
<h3 id="2017年01月19日-星期四-在electron中安装调试插件"><a href="#2017年01月19日-星期四-在electron中安装调试插件" class="headerlink" title="2017年01月19日 星期四 在electron中安装调试插件"></a>2017年01月19日 星期四 在electron中安装调试插件</h3><p>参考<a href="https://github.com/chentsulin/electron-react-boilerplate" target="_blank" rel="noopener">chentsulin/electron-react-boilerplate</a>安装一下插件：</p>
<ul>
<li>Devtron - Electron官方提供的调试插件 - Install via electron-debug.</li>
<li>React Developer Tools - React官方提供的调试插件 - Install via electron-devtools-installer.</li>
<li>Redux DevTools - Redux调试插件 - Install via electron-devtools-installer.</li>
</ul>
<p>使用<a href="https://github.com/MarshallOfSound/electron-devtools-installer" target="_blank" rel="noopener">MarshallOfSound/electron-devtools-installer</a>在Electron中安装调试插件，代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">installChromeExtensions</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (process.env.NODE_ENV === constant.env.nodeEnv.development) &#123;</span><br><span class="line">    <span class="keyword">const</span> installer = <span class="built_in">require</span>(<span class="string">'electron-devtools-installer'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> extensions = [</span><br><span class="line">      <span class="string">'REACT_DEVELOPER_TOOLS'</span>,</span><br><span class="line">      <span class="string">'REDUX_DEVTOOLS'</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> forceDownload = !!process.env.UPGRADE_EXTENSIONS;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"start to install debug extensions...."</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span></span><br><span class="line">      .all(extensions.map(<span class="function"><span class="params">name</span> =&gt;</span> installer.default(installer[name], forceDownload)))</span><br><span class="line">      .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"install debug extensions finish"</span>);</span><br><span class="line">      &#125;).catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"install debug extensions error:"</span> + err);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在app ready后调用即可。安装需要翻墙。安装后就不会再安装了，设置<code>UPGRADE_EXTENSIONS</code>可以强制更新：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ UPGRADE_EXTENSIONS=1 npm run dev</span><br><span class="line"></span><br><span class="line"># For Windows</span><br><span class="line">$ set UPGRADE_EXTENSIONS=1 &amp;&amp; npm run dev</span><br></pre></td></tr></table></figure>
<p>然后咱</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev devtron</span><br><span class="line"></span><br><span class="line">require(&apos;devtron&apos;).install()</span><br></pre></td></tr></table></figure>
<h3 id="2017年01月23日-星期一-react-redux"><a href="#2017年01月23日-星期一-react-redux" class="headerlink" title="2017年01月23日 星期一 react-redux"></a>2017年01月23日 星期一 react-redux</h3><p>学习react-redux。大致看了redux的代码，代码真心少。但是学习起来却这么不容易。。。。</p>
<p>而且还可以很强大。或许这就是UNIX设计艺术一个很好的例证。</p>
<p>结合调试扩展，真是可以在应用状态中进行时间旅行：</p>
<ul>
<li><a href="https://github.com/gaearon/redux-devtools" target="_blank" rel="noopener">redux-devtools</a></li>
<li><a href="http://www.jianshu.com/p/a2d4c1856560" target="_blank" rel="noopener">Redux-devTools简单的使用 - 简书</a></li>
</ul>
<p>但是不得不说，的确很难消化，我现在还是无法用其开始写mmnote。</p>
<p>还有，对于state，每次都要返回一个新的object么？ – 对的。</p>
<h3 id="2017年01月24日-星期二-immutable-js"><a href="#2017年01月24日-星期二-immutable-js" class="headerlink" title="2017年01月24日 星期二 immutable.js"></a>2017年01月24日 星期二 immutable.js</h3><p>immutable.js是js中的不可变数据类型库。其实用起来还是很麻烦的，尤其是获取嵌套的属性。</p>
<ul>
<li><a href="https://github.com/camsong/blog/issues/3" target="_blank" rel="noopener">Immutable 详解及 React 中实践 · Issue #3 · camsong/blog</a></li>
<li><a href="https://www.sitepoint.com/how-to-build-a-todo-app-using-react-redux-and-immutable-js/" target="_blank" rel="noopener">How to Build a Todo App Using React, Redux, and Immutable.js</a></li>
</ul>
<p>Immutable.js和redux结合有些问题，因为combineReducers针对的是普通Object。</p>
<p>有一个库实现了针对immutable.js的combineReducers：</p>
<ul>
<li><a href="https://github.com/gajus/redux-immutable" target="_blank" rel="noopener">gajus/redux-immutable: redux-immutable is used to create an equivalent function of Redux combineReducers that works with Immutable.js state.</a></li>
</ul>
<p>js的世界就是如此，这个库也不过一百来行，有800多start。。。。</p>
<ul>
<li><a href="https://segmentfault.com/a/1190000004236064?utm_source=Weibo" target="_blank" rel="noopener">解读redux工作原理 - dry - SegmentFault</a></li>
</ul>
<h3 id="2017年01月26日-星期四-异步action-使用没有类型定义的包"><a href="#2017年01月26日-星期四-异步action-使用没有类型定义的包" class="headerlink" title="2017年01月26日 星期四 异步action 使用没有类型定义的包"></a>2017年01月26日 星期四 异步action 使用没有类型定义的包</h3><p>redux的middleware有几个选择：</p>
<ul>
<li>标准的做法是使用 Redux Thunk middleware。要引入 redux-thunk 这个专门的库才能使用。我们后面会介绍 middleware 大体上是如何工作的；目前，你只需要知道一个要点：通过使用指定的 middleware，action 创建函数除了返回 action 对象外还可以返回函数。这时，这个 action 创建函数就成为了 thunk。</li>
<li>redux-promise 或者 redux-promise-middleware 来 dispatch Promise 替代函数。</li>
<li>redux-observable 来 dispatch Observable。</li>
<li><p>redux-saga 中间件来创建更加复杂的异步 action。</p>
</li>
<li><p><a href="https://www.youtube.com/watch?v=AslncyG8whg&amp;ab_channel=NetflixUIEngineering" target="_blank" rel="noopener">Netflix JavaScript Talks - RxJS + Redux + React = Amazing! - YouTube</a></p>
</li>
</ul>
<p>这个水也好深，不想再这个阶段多花时间在上面了，采用最简单原始的<code>redux-thunk</code></p>
<p><code>isomorphic-fetch</code>这个库不错，用起来。</p>
<hr>
<p>对于使用没有类型定义的包，使用<code>index.d.ts</code>，然后简单的写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">declare module &apos;redux-devtools-chart-monitor&apos;;</span><br><span class="line">declare module &apos;redux-devtools-diff-monitor&apos;;</span><br><span class="line">declare module &apos;redux-devtools-inspector&apos;;</span><br></pre></td></tr></table></figure>
<p>然后<code>/// &lt;reference path=&quot;./index.d.ts&quot; /&gt;</code></p>
<p>2017年01月28日 初一 codemirror 剪贴板图片</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">mod</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> exports == <span class="string">"object"</span> &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">module</span> == <span class="string">"object"</span>) <span class="comment">// CommonJS</span></span><br><span class="line">    mod(<span class="built_in">require</span>(<span class="string">"../../lib/codemirror"</span>), <span class="built_in">require</span>(<span class="string">"../markdown/markdown"</span>), <span class="built_in">require</span>(<span class="string">"../../addon/mode/overlay"</span>));</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> define == <span class="string">"function"</span> &amp;&amp; define.amd) <span class="comment">// AMD</span></span><br><span class="line">    define([<span class="string">"../../lib/codemirror"</span>, <span class="string">"../markdown/markdown"</span>, <span class="string">"../../addon/mode/overlay"</span>], mod);</span><br><span class="line">  <span class="keyword">else</span> <span class="comment">// Plain browser env</span></span><br><span class="line">    mod(CodeMirror);</span><br><span class="line">&#125;)(<span class="function"><span class="keyword">function</span>(<span class="params">CodeMirror</span>) </span>&#123;</span><br></pre></td></tr></table></figure>
<p>除了原始浏览器环境，其他环境中引入gfm mode就会自动引入依赖的markdown mode和overlay插件。</p>
<p>先不弄树控件了，作为一个插件实现吧(?)。</p>
<p>接下来做获取剪贴板图片。</p>
<ul>
<li>这篇文章中CM作者使用change事件处理粘贴文字的做法值得学习 <a href="https://github.com/codemirror/CodeMirror/issues/2120" target="_blank" rel="noopener">Paste with indent? · Issue #2120 · codemirror/CodeMirror</a></li>
</ul>
<p>使用change对象的origin===’paste’来处理粘贴的场景。但是粘贴图片不会触发这个事件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/input/input.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">handlePaste</span>(<span class="params">e, cm</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> pasted = e.clipboardData &amp;&amp; e.clipboardData.getData(<span class="string">"Text"</span>)</span><br><span class="line">  <span class="keyword">if</span> (pasted) &#123;</span><br><span class="line">    e.preventDefault()</span><br><span class="line">    <span class="keyword">if</span> (!cm.isReadOnly() &amp;&amp; !cm.options.disableInput)</span><br><span class="line">      runInOp(cm, () =&gt; applyTextInput(cm, pasted, <span class="number">0</span>, <span class="literal">null</span>, <span class="string">"paste"</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>CM的默认处理，如果不是文字，是不会有行为的。</p>
<p>图片拖拽上传插件：</p>
<ul>
<li>⭐️<a href="https://segmentfault.com/a/1190000007434697" target="_blank" rel="noopener">js拖拽粘贴上传与CodeMirror - 小小懒羊羊SF专栏 - SegmentFault</a></li>
<li><a href="https://github.com/Rovak/InlineAttachment" target="_blank" rel="noopener">Rovak/InlineAttachment: Easily paste and upload files/images in plain textareas</a></li>
</ul>
<p>widget demo值得学习：</p>
<ul>
<li><a href="https://codemirror.net/demo/widget.html" target="_blank" rel="noopener">CodeMirror: Inline Widget Demo</a></li>
</ul>
<p>参考上面的文章知道了做法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">myCodeMirror.on(<span class="string">'paste'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">instance, e</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'paste'</span>,instance,e);</span><br><span class="line">    e.preventDefault();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">e.clipboardData.items[<span class="number">0</span>].getAsFile()</span><br><span class="line"><span class="comment">// =&gt; Blob &#123;size: 12312, type: "image/png"&#125;</span></span><br></pre></td></tr></table></figure>
<p>如何保存Blob到文件中？</p>
<ul>
<li><a href="https://www.npmjs.com/package/blob-to-buffer" target="_blank" rel="noopener">blob-to-buffer</a></li>
</ul>
<p>使用这个库把blob转为buffer即可。</p>
<p>同时发现了依赖这个库的一个很有意思的项目：</p>
<ul>
<li><a href="https://www.npmjs.com/package/blob-to-buffer" target="_blank" rel="noopener">blob-to-buffer</a></li>
</ul>
<p>基于CM的markdown编辑器，做得很不错，很多地方都在用：</p>
<ul>
<li>⭐️<a href="https://github.com/NextStepWebs/simplemde-markdown-editor" target="_blank" rel="noopener">NextStepWebs/simplemde-markdown-editor: A simple, beautiful, and embeddable JavaScript Markdown editor. Delightful editing for beginners and experts alike. Features built-in autosaving and spell checking.</a></li>
</ul>
<hr>
<p>可以从剪贴板保存图片到本地了，但是图片清晰度不够，这里有一个类似的问题：</p>
<ul>
<li><a href="http://stackoverflow.com/questions/22135549/javascript-how-do-i-access-hi-dpi-retina-image-from-the-clipboard-on-a-paste-ev" target="_blank" rel="noopener">Javascript: How do I access Hi-DPI/Retina image from the clipboard on a paste event? - Stack Overflow</a></li>
</ul>
<p>但是没有回答。我看了github的markdown编辑控件，上传的图片是高清的。。。如何做到。</p>
<p>要被整疯了。。。</p>
<p><img src="../../../img/2017-01-28-23-44-47.png" alt=""></p>
<h3 id="2017年01月29日-星期日"><a href="#2017年01月29日-星期日" class="headerlink" title="2017年01月29日 星期日"></a>2017年01月29日 星期日</h3><ul>
<li><a href="https://github.com/electron/electron/pull/7909" target="_blank" rel="noopener">Chrome 54 update by groundwater · Pull Request #7909 · electron/electron</a></li>
<li><a href="https://bugs.chromium.org/p/chromium/issues/detail?id=355477" target="_blank" rel="noopener">355477 - Pasting images doesn’t preserve original resolution - chromium - Monorail</a></li>
</ul>
<p>这个人问的问题一模一样。难道这个问题这么多年了没人管？？？</p>
<p>现在我用的浏览器是55，而electron使用的是53。下载一个53的chrome看看。</p>
<p>老版本网址：</p>
<ul>
<li><a href="http://google-chrome.en.uptodown.com/mac/old" target="_blank" rel="noopener">Google Chrome old versions - Mac</a></li>
<li><a href="http://filehippo.com/zh/mac/download_google_chrome_for_mac/history" target="_blank" rel="noopener">Google Chrome 56.0.2924.76-历史 -FileHippo.com</a></li>
</ul>
<p>关闭自动更新：</p>
<ul>
<li><a href="http://support.imonggo.com/help/kb/advance-questions/how-to-install-a-previous-version-of-chrome-in-mac" target="_blank" rel="noopener">How to install a previous version of Chrome in Mac / Advanced Questions / Knowledge Base - Imonggo Support</a></li>
<li><a href="http://support.imonggo.com/help/kb/advance-questions/how-to-stop-google-chrome-from-auto-updates-for-mac" target="_blank" rel="noopener">How to Stop Google Chrome from Auto-Updates for Mac / Advanced Questions / Knowledge Base - Imonggo Support</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">defaults read com.google.Keystone.Agent checkInterval // =&gt; 18000</span><br><span class="line"></span><br><span class="line">关闭：</span><br><span class="line">defaults write com.google.Keystone.Agent checkInterval 0</span><br></pre></td></tr></table></figure>
<p>控制台中检查版本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">navigator.appVersion</span><br></pre></td></tr></table></figure>
<p>实验网址：<a href="http://jsfiddle.net/zd5pX/44/" target="_blank" rel="noopener">http://jsfiddle.net/zd5pX/44/</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Click this pane, and paste<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">""</span> <span class="attr">alt</span>=<span class="string">""</span> <span class="attr">id</span>=<span class="string">"img"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">'html'</span>).bind(<span class="string">'paste'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    <span class="keyword">var</span> item = (e.clipboardData || e.originalEvent.clipboardData).items[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">var</span> type = item.type.split(<span class="string">'/'</span>).shift();</span><br><span class="line">    <span class="keyword">if</span> (type == <span class="string">"image"</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> file = item.getAsFile();</span><br><span class="line">        <span class="keyword">var</span> blob = URL.createObjectURL(file); <span class="comment">// Blob</span></span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">'img'</span>).src = blob;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>结论：55版本中才修复。electron下个版本为1.5.0，使用的chrome版本为54。。。。等吧。</p>
<h3 id="2017年02月03日-星期五-粘贴图片"><a href="#2017年02月03日-星期五-粘贴图片" class="headerlink" title="2017年02月03日 星期五 粘贴图片"></a>2017年02月03日 星期五 粘贴图片</h3><p>完成粘贴图片！目前使用的是inline widget，之后再优化别的形式。</p>
<p><img src="/img/mmnote-can-paste-image.png" alt=""></p>
<p>下一步是实时预览。然后是图片可以删除。</p>
<h3 id="2017年02月05日-星期日"><a href="#2017年02月05日-星期日" class="headerlink" title="2017年02月05日 星期日"></a>2017年02月05日 星期日</h3><p>学习Abricotine，使用<code>is-url</code>来判断字符串是否是url</p>
<p>当前问题：markText后，光标有些问题</p>
<h3 id="2017年02月08日-星期三"><a href="#2017年02月08日-星期三" class="headerlink" title="2017年02月08日 星期三"></a>2017年02月08日 星期三</h3><blockquote>
<p>问题：markText后，光标有些问题</p>
</blockquote>
<p>解决：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> element = <span class="built_in">document</span>.createElement(<span class="string">'img'</span>);</span><br><span class="line">element.src = <span class="string">'file://'</span> + link;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> marker = doc.markText(<span class="keyword">from</span>, to, &#123;</span><br><span class="line">    replacedWith: element,</span><br><span class="line">    handleMouseEvents: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">element.addEventListener(<span class="string">"load"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    marker.changed();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>需要调用<code>marker.changed()</code>，这样CM会更具当前marker的大小来更新编辑器以及光标。</p>
<ul>
<li><a href="https://blog.mariusschulz.com/2015/11/13/typing-destructured-object-parameters-in-typescript" target="_blank" rel="noopener">Typing Destructured Object Parameters in TypeScript | Marius Schulz</a></li>
</ul>
<p>当前任务：[task-11]错误的图片逻辑：</p>
<ol>
<li>标红</li>
<li>编辑过程中如果不在满足图片语法，则退化为普通文本</li>
<li>编辑过程中如果图片合法了，则渲染为图片</li>
</ol>
<h3 id="2017年02月09日-星期四-列表补全-标题大小区分"><a href="#2017年02月09日-星期四-列表补全-标题大小区分" class="headerlink" title="2017年02月09日 星期四 列表补全 标题大小区分"></a>2017年02月09日 星期四 列表补全 标题大小区分</h3><p>使用img的error事件完成错误处理的需求[task-11]。</p>
<p>下一步任务：完善编辑体验（学习SimpleMDE）</p>
<ol>
<li>[task-12-✅]列表等回车会自动补全前缀 </li>
<li>[task-13]代码块背景色</li>
<li>[task-14-✅]不同级别的标题大小不一样 </li>
<li>[task-15]图片被选中时，变色</li>
<li>学习如何编写codemirror mode</li>
<li>[task-16]图片宽度最大为编辑器宽度</li>
</ol>
<p><strong>[task-12]:</strong></p>
<p><code>addon/edit/continuelist.js</code>,这个插件添加了<code>newlineAndIndentContinueMarkdownList</code>命令，将他绑定到Enter上即可。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> editor = CodeMirror.fromTextArea(<span class="built_in">document</span>.getElementById(<span class="string">"code"</span>), &#123;</span><br><span class="line">    mode: <span class="string">'gfm'</span>,</span><br><span class="line">    lineNumbers: <span class="literal">true</span>,</span><br><span class="line">    theme: <span class="string">"default"</span>,</span><br><span class="line">    extraKeys: &#123;<span class="string">"Enter"</span>: <span class="string">"newlineAndIndentContinueMarkdownList"</span>&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>[task-14]：</strong></p>
<p>在css中添加<code>.CodeMirror .CodeMirror-code .cm-header-1~4</code>的样式即可：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.CodeMirror</span> <span class="selector-class">.CodeMirror-code</span> <span class="selector-class">.cm-header-1</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">200%</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">200%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.CodeMirror</span> <span class="selector-class">.CodeMirror-code</span> <span class="selector-class">.cm-header-2</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">160%</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">160%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.CodeMirror</span> <span class="selector-class">.CodeMirror-code</span> <span class="selector-class">.cm-header-3</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">125%</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">125%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.CodeMirror</span> <span class="selector-class">.CodeMirror-code</span> <span class="selector-class">.cm-header-4</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">110%</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">110%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2017年02月10日-星期六-打包-编辑器卡顿排查"><a href="#2017年02月10日-星期六-打包-编辑器卡顿排查" class="headerlink" title="2017年02月10日 星期六 打包 编辑器卡顿排查"></a>2017年02月10日 星期六 打包 编辑器卡顿排查</h3><p><code>beforeSelectionChange</code>事件，会在选区变化时，但是生效前触发，返回的对象包含：{ranges, origin, update}，可以调用update方法来更新选区。</p>
<p>完成文章：<a href="http://mushanshitiancai.github.io/2017/02/11/js/electron/%E6%89%93%E5%8C%85Electron%E5%BA%94%E7%94%A8/">打包Electron应用 | 木杉的博客</a></p>
<p>目前支持粘贴/预览图片的最新DEMO：</p>
<p><img src="/img/mmnote-demo-170210.png" alt=""></p>
<p>大致的架构图：</p>
<p><img src="/img/mmnote-architecture-170211.svg" alt=""></p>
<p>下一步任务：</p>
<ol>
<li>[task-17-❌]更新文档的state结构，在编辑器编辑时，不更新state（如果更新会导致效率低下）。只在save时更新state。</li>
</ol>
<p>Editor现在传入的props是一个url，这个不太不和目前的逻辑了。目前使用了CM的Doc，所以一个editor其实承载了多个doc，只是同时只显示当前doc。</p>
<p>=&gt; 发现如果在编辑器更新时不更新state，那么就不是react+redux的模式了，写起来无从下手。。。参考了<a href="https://github.com/JedWatson/react-codemirror" target="_blank" rel="noopener">JedWatson/react-codemirror</a>，发现他的更新模式和我之前写的一样，先onChange，然后更新props后再比较value，这样看起来真的是非常低效啊。但是他的demo并没有出现卡顿的现象。</p>
<p>经过排查，发现如果关闭Redux的DevTools中间件，卡顿就消失了。看来是因为输入时频繁更新state，导致devtool出现瓶颈（人家毕竟是提供时间旅行的。。。）</p>
<h3 id="2017年02月12日-星期日-了解Draft-js-File-URI-state思考"><a href="#2017年02月12日-星期日-了解Draft-js-File-URI-state思考" class="headerlink" title="2017年02月12日 星期日 了解Draft.js File URI state思考"></a>2017年02月12日 星期日 了解Draft.js File URI state思考</h3><ul>
<li><a href="https://facebook.github.io/draft-js/" target="_blank" rel="noopener">Draft.js | Rich Text Editor Framework for React</a></li>
</ul>
<p>这是simplenote使用的编辑器控件，是Facebook推出的一个原生支持React的编辑器。</p>
<ol>
<li>[task-18-✅]Draft.js是如何接受外部指令的？比如replace？</li>
</ol>
<hr>
<p>为了所谓之扩展性，所有的笔记路径使用uri格式</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/File_URI_scheme#cite_note-2" target="_blank" rel="noopener">file URI scheme - Wikipedia</a></li>
<li><a href="https://blogs.msdn.microsoft.com/ie/2006/12/06/file-uris-in-windows/" target="_blank" rel="noopener">File URIs in Windows – IEBlog</a></li>
</ul>
<p>工具：</p>
<ul>
<li><a href="https://github.com/medialize/URI.js" target="_blank" rel="noopener">medialize/URI.js: Javascript URL mutation library</a></li>
</ul>
<p>我需要的能力：</p>
<ol>
<li>判断协议</li>
<li>如果是file，获取对应的本地path（<a href="https://github.com/TooTallNate/file-uri-to-path" target="_blank" rel="noopener">TooTallNate/file-uri-to-path: Convert a file: URI to a file path</a>）</li>
<li>本地path变为file uri（<a href="https://www.npmjs.com/package/file-url" target="_blank" rel="noopener">file-url</a>）</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn add urijs file-uri-to-path file-url</span><br><span class="line">yarn add @types/urijs @types/file-url</span><br></pre></td></tr></table></figure>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">module</span> 'file-uri-to-path' &#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">uri2path</span>(<span class="params">uri: <span class="built_in">string</span></span>): <span class="title">string</span></span>;</span><br><span class="line">    <span class="keyword">export</span> = uri2path;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>现在state的定义和使用都非常的不方便！😤</p>
<p>因为使用了immutable.js，导致获取和更新都非常的不方便，获取必须使用get，类型定义完全无效了，而且嵌套的还得使用get([‘a’,’b’]),简直恶心到逆天，而且state更新还必须从顶级往下更新才行。</p>
<p>参考了draft.js和simplenote，有了几点结论：</p>
<ol>
<li>状态的维护比较恶心是不可避免的，因为draft.js中，更新EditorState也不简单，都是从EditorState这个顶级state开始更新其中的子state的，使用set或者put，或者util。。。</li>
<li>获取状态可以使用自定义的方法来获取，其中包装immutable的get，这样不会恶心到外面去，但是重复代码量很多。。。。</li>
<li>draft.js比较豪华，所有子状态，只要不是简单类型的，都是自定义Record或者自定义其他数据结构，样板代码量很大。</li>
<li>state尽量扁平化吧，会不那么恶心一点，比如simplenote基本只有一层</li>
<li>simplenote把远端服务的Bucket直接放到state中去，这样做好吗？</li>
</ol>
<h3 id="2017年02月13日-星期一"><a href="#2017年02月13日-星期一" class="headerlink" title="2017年02月13日 星期一"></a>2017年02月13日 星期一</h3><p>继续纠结redux的state的问题。</p>
<ul>
<li><a href="http://cn.redux.js.org/docs/recipes/reducers/NormalizingStateShape.html" target="_blank" rel="noopener">State 范式化 | Redux 中文文档 Join the chat at https://gitter.im/camsong/redux-in-chinese</a></li>
</ul>
<blockquote>
<p>上面的数据结构比较复杂，并且有部分数据是重复的。这里还存在一些让人关心的问题：</p>
<ol>
<li>当数据在多处冗余后，需要更新时，很难保证所有的数据都进行更新。</li>
<li>嵌套的数据意味着 reducer 逻辑嵌套更多、复杂度更高。尤其是在打算更新深层嵌套数据时。</li>
<li>不可变的数据在更新时需要状态树的祖先数据进行复制和更新，并且新的对象引用会导致与之 connect 的所有 UI 组件都重复 render。尽管要显示的数据没有发生任何改变，对深层嵌套的数据对象进行更新也会强制完全无关的 UI 组件重复 render<br>正因为如此，在 Redux Store 中管理关系数据或嵌套数据的推荐做法是将这一部分视为<strong>数据库</strong>，并且将数据按范式化存储。</li>
</ol>
</blockquote>
<ul>
<li><a href="http://cn.redux.js.org/docs/recipes/reducers/ImmutableUpdatePatterns.html" target="_blank" rel="noopener">不可变更新模式 | Redux 中文文档 Join the chat at https://gitter.im/camsong/redux-in-chinese</a></li>
</ul>
<blockquote>
<p>正确方法：复制嵌套数据的所有层级</p>
<p>不幸的是，正确地使用不变的更新去深度嵌套状态的过程很容易变得冗长难读。 更新 ate.first.second[someId].fourth 的示例大概如下所示：</p>
</blockquote>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function updateVeryNestedField(state, action) &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        ....state,</span><br><span class="line">        first : &#123;</span><br><span class="line">            ...state.first,</span><br><span class="line">            second : &#123;</span><br><span class="line">                ...state.first.second,</span><br><span class="line">                [action.someId] : &#123;</span><br><span class="line">                    ...state.first.second[action.someId],</span><br><span class="line">                    fourth : action.someValue</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</code></pre><blockquote>
<p>显然，每一层嵌套使得阅读更加困难，并给了更多犯错的机会。这是其中一个原因，鼓励你保持状态扁平，尽可能构建 reducer。</p>
</blockquote>
<p>简直是灾难。。。。</p>
<p>immutable的Cursor用起来：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Cursor = <span class="built_in">require</span>(<span class="string">'immutable/contrib/cursor'</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://segmentfault.com/a/1190000003910357" target="_blank" rel="noopener">Immutable 详解及 React 中实践 - pure render - SegmentFault</a></li>
</ul>
<h3 id="2017年02月18日-星期六-tree-view结合Redux-软链接处理-fs-promise"><a href="#2017年02月18日-星期六-tree-view结合Redux-软链接处理-fs-promise" class="headerlink" title="2017年02月18日 星期六 tree-view结合Redux 软链接处理 fs-promise"></a>2017年02月18日 星期六 tree-view结合Redux 软链接处理 fs-promise</h3><p>Redux 官方 <a href="https://github.com/reactjs/redux/tree/master/examples/tree-view" target="_blank" rel="noopener">Tree View</a> 示例:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/reactjs/redux.git</span><br><span class="line"></span><br><span class="line">cd redux/examples/tree-view</span><br><span class="line">npm install</span><br><span class="line">npm start</span><br></pre></td></tr></table></figure>
<p>open <a href="http://localhost:3000/" target="_blank" rel="noopener">http://localhost:3000/</a></p>
<blockquote>
<p>该示例展示了深层嵌套树状视图的渲染，以及为了方便 reducer 更新，state 的标准化写法。优良的渲染表现，来自于容器组件细粒度的、仅针对需要渲染的 tree node 的绑定。</p>
</blockquote>
<p>这个例子中，树结构被拉平了。这是redux的state的标准化写法，方便更新。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tree = &#123;</span><br><span class="line">    <span class="number">0</span>: &#123;</span><br><span class="line">      id: <span class="number">0</span>,</span><br><span class="line">      counter: <span class="number">0</span>,</span><br><span class="line">      childIds: [],</span><br><span class="line">      parentId: <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>不同软件对于软链接的处理是如何的呢？</p>
<p><img src="/img/mmnote-sublime-ln-file.png" alt=""></p>
<p><img src="/img/mmnote-vscode-ln-file.png" alt=""></p>
<p>我倾向于vscode，但是软链接的文件夹是不是应该用不同的logo？</p>
<hr>
<p>移入fs-promise后，webpack会报错，参考：</p>
<ul>
<li><a href="https://github.com/kevinbeaty/any-promise/issues/27" target="_blank" rel="noopener">Module parse failed: /…/node_modules/any-promise/LICENSE Unexpected token · Issue #27 · kevinbeaty/any-promise</a></li>
</ul>
<p>在webpack配置中添加：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.NormalModuleReplacementPlugin(<span class="regexp">/^any\-promise$/</span>, <span class="string">'bluebird'</span>),</span><br><span class="line">],</span><br></pre></td></tr></table></figure>
<h3 id="2017年02月19日-星期日"><a href="#2017年02月19日-星期日" class="headerlink" title="2017年02月19日 星期日"></a>2017年02月19日 星期日</h3><ul>
<li>[task-19-✅]整合目录树和文档</li>
</ul>
<p><strong>[task-19]</strong></p>
<p>这个整合完，第一阶段就差不多了。现在有几点体会：</p>
<ol>
<li>React+Redux这一套很强，但是我作为从OO这个体系过来的，脑子还是没有完全转过弯来，对于不是“组件.操作(数据)”这种模式还是不适用，老想着直接操作组件。</li>
<li>React+Redux这一套很强，但是使用起来不是很简单，组件的编写还好，但是状态这一块简直不能再恶心了。。。虽然用上Immutable后，拼装新的state返回这个不那么乱了，但是读取和更新状态，真心麻烦。。。而且类型系统扑街</li>
</ol>
<p><img src="/img/mmnote-redux-state-complex.png" alt=""></p>
<p>为了尽快吧这个项目写出来，最近有些焦虑症了，影响随眠的级别。。。真担心胃炎因此又犯了。</p>
<p><img src="/img/mmnote-combine-tree-and-editor.png" alt=""></p>
<h3 id="2017年02月20日-星期一"><a href="#2017年02月20日-星期一" class="headerlink" title="2017年02月20日 星期一"></a>2017年02月20日 星期一</h3><p>提示Warning：<code>Warning: a promise was created in a handler but was not returned from it</code></p>
<p>参考：<a href="http://bluebirdjs.com/docs/warning-explanations.html#warning-a-promise-was-created-in-a-handler-but-was-not-returned-from-it" target="_blank" rel="noopener">Warning Explanations | bluebird</a></p>
<p>例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fsp.stat(path).then(<span class="function"><span class="params">stats</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (stats.isFile()) &#123;</span><br><span class="line">        dispatch(openFileAction(path));</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (stats.isDirectory()) &#123;</span><br><span class="line">        dispatch(openFolderAction(path));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;  <span class="comment">// &lt;-- 后面有catch或者then必须加，不然就警告了</span></span><br><span class="line">&#125;).catch(sendFailAction(dispatch, ACT_OPEN_FAIL));</span><br></pre></td></tr></table></figure>
<ul>
<li>[task-20]图片和文字在同一行时，编辑文字不正常</li>
</ul>
<h3 id="2017年02月22日-星期三"><a href="#2017年02月22日-星期三" class="headerlink" title="2017年02月22日 星期三"></a>2017年02月22日 星期三</h3><p>查Immutable.js的用起来痛苦的资料，到了vue.js，发现了提到了MobX，了解了一下，原来是React上新的状态管理框架。查了下，都说比Redux好写很多，大致了解一下，感觉不错。</p>
<ul>
<li><a href="http://cn.vuejs.org/v2/guide/comparison.html#MobX" target="_blank" rel="noopener">对比其他框架 - vue.js</a> </li>
<li><a href="https://mobx.js.org/faq/blogs.html" target="_blank" rel="noopener">Tutorials, videos and blogs | MobX</a></li>
</ul>
<h3 id="2017年02月26日-星期日-初步整合kityminder-学习mobx"><a href="#2017年02月26日-星期日-初步整合kityminder-学习mobx" class="headerlink" title="2017年02月26日 星期日 初步整合kityminder 学习mobx"></a>2017年02月26日 星期日 初步整合kityminder 学习mobx</h3><p><img src="/img/mmnote-add-kityminder.png" alt=""></p>
<p>看完了mobx教程，牛逼，这样就实现了自动更新了，写起来绝对比redux这种轻松很多。至于状态是可变的，目前看来只是不能时间旅行了。</p>
<p>大致用了一下，爽！最爽的一点是可以直接范围对象属性了，而不是使用immutable哪种恶心的访问方式。这就可以用上typescript的类型优势了。</p>
</div><div class="reward"><hr><div class="text">如果觉得文章对你有帮助，就打赏杯咖啡钱呗😊</div><img src="/img/reward/weixin.png"><img src="/img/reward/alipay.png"></div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://mushanshitiancai.github.io/2016/12/21/project/mmnote/MMNote开发笔记/" data-id="cjk56xl9a00m8oj31d4adtu1r" class="article-share-link">分享</a><div class="tags"><a href="/tags/mmnote/">mmnote</a></div><div class="post-nav"><a href="/2016/12/21/js/css/CSS笔记-CSS-in-JS/" class="pre">CSS笔记-CSS in JS</a><a href="/2016/12/13/js/react/React资源收集/" class="next">React资源收集</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论 「请确保 disqus.com 可以正常加载」</button></div><script>var disqus_shortname = 'mushan';
var disqus_identifier = '2016/12/21/project/mmnote/MMNote开发笔记/';
var disqus_title = 'MMNote开发笔记';
var disqus_url = 'http://mushanshitiancai.github.io/2016/12/21/project/mmnote/MMNote开发笔记/';
$('.btn_click_load').click(function() {
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  $('.btn_click_load').css('display','none');
});
$.ajax({
  url: 'https://disqus.com/favicon.ico',
  timeout: 3000,
  type: 'GET',
  success: (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    $('.btn_click_load').css('display','none');
  })(),
  error: function() {
    $('.btn_click_load').css('display','block');
  }
});</script><script id="dsq-count-scr" src="//mushan.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://mushanshitiancai.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Java/Groovy/">Groovy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/JDK源码阅读/">JDK源码阅读</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/Spring/">Spring</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/掌握Java/">掌握Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/调试/">调试</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/TypeScript/">TypeScript</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MongoDB/">MongoDB</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/RabbitMQ/">RabbitMQ</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tomcat/">Tomcat</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/electron/">electron</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/自动化/">自动化</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/自己动手写操作系统/">自己动手写操作系统</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/bochs/" style="font-size: 15px;">bochs</a> <a href="/tags/work/" style="font-size: 15px;">work</a> <a href="/tags/log/" style="font-size: 15px;">log</a> <a href="/tags/js/" style="font-size: 15px;">js</a> <a href="/tags/angularjs/" style="font-size: 15px;">angularjs</a> <a href="/tags/db/" style="font-size: 15px;">db</a> <a href="/tags/mongodb/" style="font-size: 15px;">mongodb</a> <a href="/tags/react/" style="font-size: 15px;">react</a> <a href="/tags/mmnote/" style="font-size: 15px;">mmnote</a> <a href="/tags/architecture/" style="font-size: 15px;">architecture</a> <a href="/tags/protocol-buffers/" style="font-size: 15px;">protocol-buffers</a> <a href="/tags/mq/" style="font-size: 15px;">mq</a> <a href="/tags/blog/" style="font-size: 15px;">blog</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/tools/" style="font-size: 15px;">tools</a> <a href="/tags/emacs/" style="font-size: 15px;">emacs</a> <a href="/tags/管理后台/" style="font-size: 15px;">管理后台</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/shell/" style="font-size: 15px;">shell</a> <a href="/tags/os/" style="font-size: 15px;">os</a> <a href="/tags/tmux/" style="font-size: 15px;">tmux</a> <a href="/tags/vagrant/" style="font-size: 15px;">vagrant</a> <a href="/tags/mac/" style="font-size: 15px;">mac</a> <a href="/tags/automation/" style="font-size: 15px;">automation</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/http/" style="font-size: 15px;">http</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/nginx/" style="font-size: 15px;">nginx</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/php/" style="font-size: 15px;">php</a> <a href="/tags/project/" style="font-size: 15px;">project</a> <a href="/tags/software/" style="font-size: 15px;">software</a> <a href="/tags/test/" style="font-size: 15px;">test</a> <a href="/tags/ffmpeg/" style="font-size: 15px;">ffmpeg</a> <a href="/tags/gm/" style="font-size: 15px;">gm</a> <a href="/tags/graphicsmagick/" style="font-size: 15px;">graphicsmagick</a> <a href="/tags/wireshark/" style="font-size: 15px;">wireshark</a> <a href="/tags/vscode/" style="font-size: 15px;">vscode</a> <a href="/tags/web/" style="font-size: 15px;">web</a> <a href="/tags/curl/" style="font-size: 15px;">curl</a> <a href="/tags/javafx/" style="font-size: 15px;">javafx</a> <a href="/tags/jvm/" style="font-size: 15px;">jvm</a> <a href="/tags/junit/" style="font-size: 15px;">junit</a> <a href="/tags/groovy/" style="font-size: 15px;">groovy</a> <a href="/tags/idea/" style="font-size: 15px;">idea</a> <a href="/tags/tomcat/" style="font-size: 15px;">tomcat</a> <a href="/tags/maven/" style="font-size: 15px;">maven</a> <a href="/tags/guava/" style="font-size: 15px;">guava</a> <a href="/tags/doclet/" style="font-size: 15px;">doclet</a> <a href="/tags/log4j/" style="font-size: 15px;">log4j</a> <a href="/tags/servlet/" style="font-size: 15px;">servlet</a> <a href="/tags/dubbo/" style="font-size: 15px;">dubbo</a> <a href="/tags/spring/" style="font-size: 15px;">spring</a> <a href="/tags/electron/" style="font-size: 15px;">electron</a> <a href="/tags/javascript/" style="font-size: 15px;">javascript</a> <a href="/tags/css/" style="font-size: 15px;">css</a> <a href="/tags/jquery/" style="font-size: 15px;">jquery</a> <a href="/tags/nodejs/" style="font-size: 15px;">nodejs</a> <a href="/tags/typescript/" style="font-size: 15px;">typescript</a> <a href="/tags/webpack/" style="font-size: 15px;">webpack</a> <a href="/tags/ts/" style="font-size: 15px;">ts</a> <a href="/tags/gulp/" style="font-size: 15px;">gulp</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/07/28/java/language/Java日志-Log4j源码分析/">Java日志-Log4j源码分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/22/java/language/Java日志-SLF4J使用与源码分析/">Java日志-SLF4J使用与源码分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/11/os/自己动手写操作系统-计算机通电之后的操作/">自己动手写操作系统-计算机通电之后的操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/11/os/Bochs学习-安装配置篇/">Bochs学习-安装配置篇</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/18/java/language/Java如何保证文件落盘？/">Java如何保证文件落盘？</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/17/linux/Linux-UNIX编程如何保证文件落盘/">Linux/UNIX编程如何保证文件落盘</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/07/db/MongoDB遍历方式对比/">MongoDB遍历方式对比</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/04/java/language/JDK源码阅读-RandomAccessFile/">JDK源码阅读-RandomAccessFile</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/04/java/language/JDK源码阅读-FileOutputStream/">JDK源码阅读-FileOutputStream</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/03/java/language/JDK源码阅读-FileInputStream/">JDK源码阅读-FileInputStream</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近评论</i></div><script type="text/javascript" src="//mushan.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://anotom.com/" title="鑫哥的博客" target="_blank">鑫哥的博客</a><ul></ul><a href="https://www.caylor.cc/" title="乐哥的博客" target="_blank">乐哥的博客</a><ul></ul><a href="http://zach41.github.io/" title="小美的博客" target="_blank">小美的博客</a><ul></ul><a href="http://blog.csdn.net/sinat_25127047" title="瀚文的博客" target="_blank">瀚文的博客</a><ul></ul><a href="http://blog.csdn.net/xiaohangblog?viewmode=contents)" title="小杭的博客" target="_blank">小杭的博客</a><ul></ul><a href="http://bettercuicui.github.io/" title="夏侯的博客" target="_blank">夏侯的博客</a><ul></ul><a href="http://damye.github.io/" title="符尧的博客" target="_blank">符尧的博客</a><ul></ul><a href="http://blog.shrp.me/" title="尚弟的博客" target="_blank">尚弟的博客</a><ul></ul><a href="http://imethan.cn" title="应锋的博客" target="_blank">应锋的博客</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">木杉的博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>