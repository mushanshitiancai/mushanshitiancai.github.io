<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="è¿™æ˜¯æœ¨æ‰çš„ä¸ªäººåšå®¢"><title>Tomcatç¬”è®°-ä¸Šä¼ çš„è¯·æ±‚ä½“Tomcatæ˜¯å¦ä¼šå…¨éƒ¨æ¶ˆè´¹æ‰ï¼Ÿ | æœ¨æ‰çš„åšå®¢</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?ec7ecb4616a008addeb60c9709230453";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Tomcatç¬”è®°-ä¸Šä¼ çš„è¯·æ±‚ä½“Tomcatæ˜¯å¦ä¼šå…¨éƒ¨æ¶ˆè´¹æ‰ï¼Ÿ</h1><a id="logo" href="/.">æœ¨æ‰çš„åšå®¢</a><p class="description">è¦ä¹ˆç²¾é€šï¼Œè¦ä¹ˆæ­»</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/about/"><i class="fa fa-user"> å…³äº</i></a><a href="/atom.xml"><i class="fa fa-rss"> è®¢é˜…</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Tomcatç¬”è®°-ä¸Šä¼ çš„è¯·æ±‚ä½“Tomcatæ˜¯å¦ä¼šå…¨éƒ¨æ¶ˆè´¹æ‰ï¼Ÿ</h1><div class="post-meta">Feb 13, 2018<span> | </span><span class="category"><a href="/categories/Tomcat/">Tomcat</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> é˜…è¯»</span></span></div><a data-disqus-identifier="2018/02/13/java/language/tomcat/Tomcatç¬”è®°-ä¸Šä¼ çš„è¯·æ±‚ä½“Tomcatæ˜¯å¦ä¼šå…¨éƒ¨æ¶ˆè´¹æ‰ï¼Ÿ/" href="/2018/02/13/java/language/tomcat/Tomcatç¬”è®°-ä¸Šä¼ çš„è¯·æ±‚ä½“Tomcatæ˜¯å¦ä¼šå…¨éƒ¨æ¶ˆè´¹æ‰ï¼Ÿ/#disqus_thread" class="disqus-comment-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">æ–‡ç« ç›®å½•</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#TCPå±‚é¢"><span class="toc-number">1.</span> <span class="toc-text">TCPå±‚é¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tomcatå±‚é¢"><span class="toc-number">2.</span> <span class="toc-text">Tomcatå±‚é¢</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æŠ“åŒ…åˆ†æ"><span class="toc-number">2.1.</span> <span class="toc-text">æŠ“åŒ…åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æºç åˆ†æ"><span class="toc-number">2.2.</span> <span class="toc-text">æºç åˆ†æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ€»ç»“"><span class="toc-number">3.</span> <span class="toc-text">æ€»ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å‚è€ƒèµ„æ–™"><span class="toc-number">4.</span> <span class="toc-text">å‚è€ƒèµ„æ–™</span></a></li></ol></div></div><div class="post-content"><p>åŒäº‹æäº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šä¸Šä¼ ä¸€ä¸ª100Mæ–‡ä»¶ï¼Œä½†æ˜¯è¯·æ±‚é€»è¾‘å¹¶æ²¡æœ‰æ¶ˆè´¹è¿™ä¸ªæ–‡ä»¶ï¼Œé‚£è¿™ä¸ªæ–‡ä»¶ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šä¹ˆï¼Ÿ</p>
<a id="more"></a>
<p>ç¬¬ä¸€ä¸ªååº”æ˜¯ä¸ä¼šï¼Œå› ä¸ºè¿™ç§æƒ…å†µä¸‹è¿™ä¸ªæ–‡ä»¶è¿˜ä¸Šä¼ ä¸Šæ¥çš„è¯ï¼Œæ˜¯å¾ˆç¬¨çš„åšæ³•ï¼Œæ˜æ˜ä¸éœ€è¦è¿™ä¸ªè¯·æ±‚ä½“çš„æ•°æ®ï¼Œä¸ºä»€ä¹ˆè¿˜è¦è¯»å–åˆ°æœåŠ¡å™¨ä¸Šã€‚ä¸è¿‡åŒäº‹çš„å®éªŒç»“æœæ˜¯ï¼Œè¶Šå¤§çš„æ–‡ä»¶è°ƒç”¨è¿™ä¸ªæ²¡æœ‰ä»»ä½•å¤„ç†é€»è¾‘çš„æ¥å£ï¼Œé€Ÿåº¦è¶Šæ…¢ï¼Œä¹Ÿå°±æ˜¯è¯´å› ä¸ºæœåŠ¡å™¨æ¥æ”¶äº†å®Œæ•´çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æ‰ä¼šæœ‰è¿™ä¸ªç°è±¡ã€‚</p>
<p>è€Œå¦å¤–ä¸€ä¸ªåŒäº‹åœ¨å®éªŒæ—¶ï¼Œå‘ç°äº†æ›´è¯¡å¼‚çš„é—®é¢˜ï¼Œä¸Šä¼ 0-2Mçš„æ–‡ä»¶å¯ä»¥æˆåŠŸï¼Œä½†æ˜¯ä¸Šä¼ å¤§äº2Mçš„æ–‡ä»¶ï¼Œä¼šæç¤ºé”™è¯¯ï¼Œä¿¡æ¯ä¸ºè¿æ¥ä¸­æ–­äº†ã€‚</p>
<h2 id="TCPå±‚é¢"><a href="#TCPå±‚é¢" class="headerlink" title="TCPå±‚é¢"></a>TCPå±‚é¢</h2><p>é¦–å…ˆè¿™ä¸ªé—®é¢˜ä»åº•å±‚æ¥çœ‹çš„è¯ï¼Œæœ‰ä¸€ä¸ªå‰ç½®é—®é¢˜ï¼Œå³å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚æ—¶ï¼ŒæœåŠ¡ç«¯ä¼šä¸€ç›´æ¥æ”¶æŠ¥æ–‡åˆ°ç¼“å†²åŒºä¸­å—ï¼Ÿä¼šå¯¼è‡´å æ»¡æœåŠ¡ç«¯èµ„æºè€Œæ— æ³•å“åº”ç ï¼Ÿä¼šå¯¼è‡´å æ»¡ç¼“å†²åŒºåä¸¢å¤±åç»­æŠ¥æ–‡çš„æ•°æ®å—ï¼Ÿ</p>
<p>ç„¶åTCPæœ‰ä¸€ä¸ªæµé‡æ§åˆ¶æœºåˆ¶ï¼Œç”¨äºæ§åˆ¶å‘é€ç«¯å‘é€æ•°æ®çš„é€Ÿç‡ï¼Œä»¥ä¾¿æ¥æ”¶ç«¯æ¥å¾—åŠæ¥æ”¶ã€‚è¿™ä¸ªé€»è¾‘å¤§è‡´æ˜¯ï¼š</p>
<p>TCPåœ¨ACKæŠ¥æ–‡ä¸­ä¼šæºå¸¦çª—å£å¤§å°ï¼Œè¯´æ˜æ¥æ”¶ç«¯ç¼“å­˜çš„çš„å‰©ä½™ç©ºé—´å¤§å°ï¼Œå‘é€ç«¯å‘é€çš„æ•°æ®ä¸ä¼šå¤§äºè¿™ä¸ªçª—å£å¤§å°ï¼Œæ‰€ä»¥å¦‚æœæ¥æ”¶æ–¹æ¥ä¸åŠæ¶ˆè´¹æ•°æ®ï¼Œåˆ™æ¥ä¸‹æ¥çš„ACKæŠ¥æ–‡ä¸­çª—å£å¤§å°ä¼šé€æ¸å‡å°ï¼Œä»¥é™åˆ¶å‘é€ç«¯å‘é€é€Ÿç‡ã€‚å¦‚æœæ¥æ”¶ç«¯ç¼“å†²åŒºæ»¡äº†ï¼ŒACKæŠ¥æ–‡ä¸­çš„çª—å£å¤§å°ä¸º0ï¼Œåˆ™å‘é€æ–¹ä¸ä¼šå†å‘é€æ•°æ®ã€‚é‚£å‘é€ç«¯æ€ä¹ˆçŸ¥é“ä½•æ—¶è¯¥ç»§ç»­å‘é€å‘¢ï¼Ÿæ–¹æ³•æ˜¯å¯åŠ¨ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œè®¡æ—¶å™¨æ—¶é—´åˆ°åå‘é€ä¸€ä¸ª1å­—èŠ‚çš„é›¶çª—å£æ£€æµ‹æŠ¥æ–‡ï¼Œç›´åˆ°è¿”å›çš„çª—å£ä¸å†ä¸ºé›¶ç„¶åç»§ç»­å‘é€æ•°æ®ã€‚</p>
<p>æ‰€ä»¥å›åˆ°ç”¨æˆ·é€šè¿‡HTTPåè®®ä¸Šä¼ å¤§æ–‡ä»¶çš„é—®é¢˜ï¼Œåœ¨TCPè¿™ä¸€å±‚ï¼Œç¼“å†²åŒºä¼šæ»¡äº†åï¼Œå®¢æˆ·ç«¯å°±ä¸ä¼šç»§ç»­å‘é€äº†ï¼Œç›´åˆ°æœåŠ¡ç«¯ç¨‹åºè¯»å–äº†æ•°æ®åï¼Œæ‰ä¼šç»§ç»­å‘é€ã€‚</p>
<h2 id="Tomcatå±‚é¢"><a href="#Tomcatå±‚é¢" class="headerlink" title="Tomcatå±‚é¢"></a>Tomcatå±‚é¢</h2><p>TCPå±‚é¢ï¼Œé€šè¿‡æµé‡æ§åˆ¶ï¼Œç”¨æˆ·å‘é€çš„æ–‡ä»¶ä¸ä¼šæ— é™åˆ¶çš„å‘é€åˆ°æœåŠ¡å™¨ä¸Šã€‚é‚£åœ¨Tomcatå±‚é¢ï¼ŒTomcatä¼šæŠŠè¯·æ±‚ä½“å®Œå…¨è¯»å–åˆ°å†…å­˜ä¸­å—ï¼Ÿ</p>
<p>è¿™ä¸ªåˆ†ä¸¤ä¸ªé˜¶æ®µè€ƒè™‘ï¼Œä¸€ä¸ªæ˜¯åœ¨Servleté€»è¾‘æ‰§è¡Œå‰ï¼ŒTomcatæ˜¯å¦ä¼šæŠŠè¯·æ±‚è¯»å–åˆ°å†…å­˜ä¸­ï¼Œä¸€ä¸ªæ˜¯ä¸šåŠ¡é€»è¾‘æ‰§è¡Œåï¼ŒTomcatæ˜¯å¦è¿˜ä¼šç»§ç»­æ¶ˆè´¹æ‰ä¸šåŠ¡é€»è¾‘æ²¡æœ‰æ¶ˆè´¹çš„è¯·æ±‚ä½“ï¼Ÿ</p>
<h3 id="æŠ“åŒ…åˆ†æ"><a href="#æŠ“åŒ…åˆ†æ" class="headerlink" title="æŠ“åŒ…åˆ†æ"></a>æŠ“åŒ…åˆ†æ</h3><p>å…ˆæŠ“åŒ…åˆ†æçœ‹çœ‹ç½‘ç»œæµé‡æ˜¯å¦‚ä½•ä¼ è¾“çš„ï¼Œå¯ä»¥å¤§è‡´çœ‹å‡ºæ¥æœåŠ¡ç«¯æ˜¯å¦æ¶ˆè´¹äº†å®¢æˆ·ç«¯çš„è¯·æ±‚ä½“ã€‚å†™ä¸€ä¸ªç®€å•çš„ä¸Šä¼ ç¨‹åºï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Upload&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">"/upload"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">    &lt;label for="file"&gt;è¯·é€‰æ‹©æ–‡ä»¶: &lt;/label&gt;&lt;input id="file" type="file" name="file"&gt;</span><br><span class="line">    &lt;input type=<span class="string">"submit"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"UploadServlet begin service"</span>);</span><br><span class="line">        System.out.println(<span class="string">"UploadServlet finish service"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åè¿è¡ŒWiresharkè¿›è¡ŒæŠ“åŒ…ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ï¼ŒWindowsä¸‹Wiresharké»˜è®¤æ— æ³•æŠ“å–æœ¬æœºå‘ç»™æœ¬æœºçš„è¯·æ±‚ï¼Œè§£å†³æ–¹æ³•è§<a href="http://mushanshitiancai.github.io/2018/02/13/tools/Wireshark%E7%AC%94%E8%AE%B0-%E6%8A%93%E5%8F%96%E6%9C%AC%E6%9C%BA%E5%8F%91%E7%BB%99%E6%9C%AC%E6%9C%BA%E7%9A%84%E8%AF%B7%E6%B1%82/">Wiresharkç¬”è®°-æŠ“å–æœ¬æœºå‘ç»™æœ¬æœºçš„è¯·æ±‚</a>ã€‚</p>
<p>æ–­ç‚¹å…ˆè®¾ç½®åœ¨UploadServlet#doPostä¸Šï¼Œçœ‹ä¸‹ä¸šåŠ¡é€»è¾‘è¯·æ±‚ä¹‹å‰ï¼Œç½‘ç»œè¯·æ±‚æ˜¯å¦‚ä½•çš„ï¼š</p>
<p><img src="/img/tomcat/wireshark-before-servlet-1.png" alt=""></p>
<p><img src="/img/tomcat/wireshark-before-servlet-2.png" alt=""></p>
<p>å¯ä»¥çœ‹å‡ºå®¢æˆ·ç«¯ä¼šä¸€ç›´å‘é€TCPæŠ¥æ–‡ï¼Œç›´åˆ°æœåŠ¡ç«¯çš„ç¼“å†²åŒºæ»¡ã€‚ç„¶åå®¢æˆ·ç«¯å¯åŠ¨å®šæ—¶å™¨åˆ¤æ–­æ˜¯å¦å¯ä»¥ç»§ç»­å‘é€å‰©ä¸‹çš„æ•°æ®ã€‚ä»ä¸Šé¢çš„æ•°æ®ï¼Œè¿˜æ— æ³•æ¨è®ºå‡ºTomcatåœ¨è®©Servletæ‰§è¡Œè¯·æ±‚å‰æ˜¯å¦è¯»å–äº†æ•°æ®ã€‚</p>
<p>æ¥ç€ç»§ç»­è¿è¡Œç¨‹åºï¼Œçœ‹ä¸‹Servleté€»è¾‘æ‰§è¡Œåï¼Œä¼šæœ‰ä»€ä¹ˆç½‘ç»œè¯·æ±‚ï¼š</p>
<p><img src="/img/tomcat/wireshark-after-servlet-1.png" alt=""></p>
<p><img src="/img/tomcat/wireshark-after-servlet-2.png" alt=""></p>
<p><img src="/img/tomcat/wireshark-after-servlet-3.png" alt=""></p>
<p>å¯ä»¥çœ‹åˆ°åœ¨Servleté€»è¾‘æ‰§è¡Œå®Œæ¯•åï¼ŒæœåŠ¡ç«¯ä¾ç„¶è¯»å–äº†å…¨éƒ¨çš„è¯·æ±‚æŠ¥æ–‡ï¼Œç„¶åæ‰å…³é—­è¿æ¥çš„ã€‚ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§è¡Œä¸ºï¼ŸServletæ‰§è¡Œå®Œæ¯•åï¼Œè¯·æ±‚æŠ¥æ–‡åº”è¯¥æ˜¯æ²¡æœ‰æ„ä¹‰äº†ï¼Œå†å»è¯»å–ï¼Œè€—æ—¶è€—åŠ›ã€‚è¿˜æ˜¯å¾—ä»æºç å±‚é¢æ¥åˆ†æçœ‹çœ‹Tomcatåœ¨Servletæ‰§è¡Œå‰åçš„å…·ä½“è¡Œä¸ºã€‚</p>
<h3 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><p>è°ƒè¯•Tomcatçš„æºç çš„æ–¹æ³•å¯ä»¥å‚è€ƒï¼š<a href="http://mushanshitiancai.github.io/2018/02/13/java/tomcat/Tomcat%E7%AC%94%E8%AE%B0-IDE%E4%B8%AD%E8%B0%83%E8%AF%95Tomcat%E6%BA%90%E7%A0%81/">Tomcatç¬”è®°-IDEä¸­è°ƒè¯•Tomcatæºç </a>ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„Tomcatç‰ˆæœ¬æ˜¯<code>7.0.84</code>ã€‚</p>
<p><code>org.apache.coyote.http11.AbstractHttp11Processor#process</code>è¿™ä¸ªå‡½æ•°æ˜¯Tomcatå¤„ç†è¯·æ±‚çš„ä¸€ä¸ªä¸»å¾ªç¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> SocketState <span class="title">process</span><span class="params">(SocketWrapper&lt;S&gt; socketWrapper)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!getErrorState().isError() &amp;&amp; keepAlive &amp;&amp; !comet &amp;&amp; !isAsync() &amp;&amp;</span><br><span class="line">            upgradeInbound == <span class="keyword">null</span> &amp;&amp;</span><br><span class="line">            httpUpgradeHandler == <span class="keyword">null</span> &amp;&amp; !endpoint.isPaused()) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è§£æHTTPå¤´éƒ¨</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            setRequestLineReadTimeout();</span><br><span class="line">            ...</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®©Adapterå¤„ç†è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è®©Servletå¤„ç†è¯·æ±‚</span></span><br><span class="line">        <span class="keyword">if</span> (!getErrorState().isError()) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                rp.setStage(org.apache.coyote.Constants.STAGE_SERVICE);</span><br><span class="line">                adapter.service(request, response);</span><br><span class="line">                </span><br><span class="line">                ...</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">               ...</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!isAsync() &amp;&amp; !comet) &#123;</span><br><span class="line">            ...</span><br><span class="line">            <span class="comment">// ç»“æŸè¯·æ±‚</span></span><br><span class="line">            endRequest();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºTomcatå¤„ç†è¯·æ±‚çš„ä¸»æµç¨‹æ˜¯ï¼š</p>
<ol>
<li>è§£æHTTPå¤´éƒ¨</li>
<li>æ‰§è¡ŒServleté€»è¾‘</li>
<li>ç»“æŸè¯·æ±‚</li>
</ol>
<p>ç»“åˆæŠ“åŒ…åˆ†æå‘ç°ï¼Œåœ¨<code>setRequestLineReadTimeout()</code>å’Œ<code>endRequest()</code>è¿™ä¸¤ä¸ªåœ°æ–¹ï¼ŒæœåŠ¡ç«¯è¯»å–äº†TCPæŠ¥æ–‡ï¼Œæ¥ä¸‹æ¥é‡ç‚¹åˆ†æä¸‹æ­¤ä¸¤å¤„ä¸ºä½•éœ€è¦è¯»å–æ•°æ®</p>
<p><code>org.apache.coyote.http11.Http11Processor#setRequestLineReadTimeout</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setRequestLineReadTimeout</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (inputBuffer.lastValid == <span class="number">0</span> &amp;&amp; socketWrapper.getLastAccess() &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»socketè¯»å–æ•°æ®åˆ°inputBufferä¸­</span></span><br><span class="line">        <span class="keyword">if</span> (!inputBuffer.fill()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> EOFException(sm.getString(<span class="string">"iib.eof.error"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>org.apache.coyote.http11.InternalInputBuffer#fill(boolean)</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">fill</span><span class="params">(<span class="keyword">boolean</span> block)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> nRead = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (parsingHeader) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœå·²ç»è¯»å–çš„æ•°æ®å¤§å°ç­‰äºbufå¤§å°ï¼ˆå¹¶ä¸”å¤–éƒ¨é€»è¾‘è¿˜åœ¨å°è¯•è¯»å–ï¼‰</span></span><br><span class="line">        <span class="comment">// è¯´æ˜è¯·æ±‚çš„å¤´éƒ¨å¤ªå¤§äº†ï¼Œæ— æ³•å¤„ç†æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">        <span class="keyword">if</span> (lastValid == buf.length) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException</span><br><span class="line">                (sm.getString(<span class="string">"iib.requestheadertoolarge.error"</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»socketçš„inputStreamè¯»å–æ•°æ®åˆ°bufä¸­ï¼Œè¯»å–çš„é•¿åº¦ä¸ºbuf.length - lastValid</span></span><br><span class="line">        <span class="comment">// lastValidä¸ºbufä¸­å·²ç»è¯»å–æ•°æ®åç§»é‡ï¼Œå¯¹äºç¬¬ä¸€æ¬¡è¯»å–å¤´éƒ¨æ—¶ï¼Œä¸º0</span></span><br><span class="line">        nRead = inputStream.read(buf, pos, buf.length - lastValid);</span><br><span class="line">        <span class="keyword">if</span> (nRead &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            lastValid = pos + nRead;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (nRead &gt; <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»<code>fill()</code>çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œè¯·æ±‚åˆ°è¾¾Tomcatåï¼ŒTomcatä¸ºäº†å¤„ç†HTTPçš„Headerä¿¡æ¯ï¼Œä¼šè¯»å–æ•°æ®åˆ°bufferæ•°ç»„ä¸­ï¼Œè€Œæ‰€èƒ½å¤„ç†çš„Headerçš„æœ€å¤§é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªæ•°æ®çš„å¤§å°ã€‚æˆ‘ä»¬å¯ä»¥è·Ÿä¸€ä¸‹çœ‹çœ‹è¿™ä¸ªæ•°ç»„æ˜¯å¦‚ä½•åˆå§‹åŒ–çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">InternalInputBuffer</span><span class="params">(Request request, <span class="keyword">int</span> headerBufferSize,</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="keyword">boolean</span> rejectIllegalHeaderName)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.request = request;</span><br><span class="line">    headers = request.getMimeHeaders();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®æ•°ç»„çš„å®¹é‡ä¸ºheaderBufferSize</span></span><br><span class="line">    buf = <span class="keyword">new</span> <span class="keyword">byte</span>[headerBufferSize];</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é»˜è®¤å€¼ä¸º8k</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> maxHttpHeaderSize = <span class="number">8</span> * <span class="number">1024</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMaxHttpHeaderSize</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> maxHttpHeaderSize; &#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMaxHttpHeaderSize</span><span class="params">(<span class="keyword">int</span> valueI)</span> </span>&#123; maxHttpHeaderSize = valueI; &#125;</span><br></pre></td></tr></table></figure>
<p>æœ€ç»ˆå¯ä»¥çœ‹åˆ°åœ¨<code>org.apache.coyote.http11.AbstractHttp11Protocol</code>è¿™ä¸ªç±»ä¸­å®šä¹‰äº†maxHttpHeaderSizeè¿™ä¸ªå˜é‡ï¼Œé»˜è®¤å€¼ä¸º8Kï¼Œä¹Ÿå°±æ˜¯è¯´Tomcaté»˜è®¤æ”¯æŒçš„æœ€é•¿Headerä¸º8Kï¼Œå†å¤§å°±ä¼šæŠ¥é”™äº†ã€‚</p>
<p>åŒæ—¶æˆ‘ä»¬å¯ä»¥ä»Tomcatçš„<a href="https://tomcat.apache.org/tomcat-7.0-doc/config/http.html" target="_blank" rel="noopener">é…ç½®æ–‡æ¡£</a>ä¸Šçœ‹åˆ°è¿™ä¸ªé…ç½®é¡¹ï¼š</p>
<p><img src="/img/tomcat/max-http-header-size.png" alt=""></p>
<p>ä¸Šé¢åˆ†æäº†Tomcatåœ¨é¢„å¤„ç†è¯·æ±‚æ—¶ï¼Œä¼šè§£æHTTPå¤´éƒ¨ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ä¼šè¯»å–ä¸€æ¬¡è¯·æ±‚ï¼Œæœ€å¤§ä¼šè¯»å–8Kã€‚é‚£ä¸ºå•¥åœ¨ç»“æŸè¯·æ±‚æ—¶ï¼ŒTomcatè¿˜ä¼šå»è¯»å–è¯·æ±‚ä½“å‘¢ï¼Ÿåˆ†æä¸€ä¸‹ç»“æŸè¯·æ±‚çš„æµç¨‹ï¼š</p>
<p><code>org.apache.coyote.http11.AbstractHttp11Processor#endRequest</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">endRequest</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç»“æŸè¯·æ±‚</span></span><br><span class="line">    <span class="keyword">if</span> (getErrorState().isIoAllowed()) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            getInputBuffer().endRequest();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (getErrorState().isIoAllowed()) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            getOutputBuffer().endRequest();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>org.apache.coyote.http11.AbstractInputBuffer#endRequest</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * End request (consumes leftover bytes).</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">endRequest</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (swallowInput &amp;&amp; (lastActiveFilter != -<span class="number">1</span>)) &#123;</span><br><span class="line">        <span class="keyword">int</span> extraBytes = (<span class="keyword">int</span>) activeFilters[lastActiveFilter].end();</span><br><span class="line">        pos = pos - extraBytes;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>org.apache.coyote.http11.filters.IdentityInputFilter#end</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">end</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">boolean</span> maxSwallowSizeExceeded = (maxSwallowSize &gt; -<span class="number">1</span> &amp;&amp; remaining &gt; maxSwallowSize);</span><br><span class="line">    <span class="keyword">long</span> swallowed = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœè¯·æ±‚ä½“å‰©ä½™çš„æ²¡æœ‰è¯»å–çš„å¤§å°å¤§äºé›¶ï¼Œåˆ™Tomcatåƒæ‰å®ƒ</span></span><br><span class="line">    <span class="keyword">while</span> (remaining &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> nread = buffer.doRead(endChunk, <span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">if</span> (nread &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">            swallowed += nread;</span><br><span class="line">            remaining = remaining - nread;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å¦‚æœè¯»å–äº†å¤ªå¤šäº†å­—èŠ‚ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">            <span class="keyword">if</span> (maxSwallowSizeExceeded &amp;&amp; swallowed &gt; maxSwallowSize) &#123;</span><br><span class="line">                <span class="comment">// Note: We do not fail early so the client has a chance to</span></span><br><span class="line">                <span class="comment">// read the response before the connection is closed. See:</span></span><br><span class="line">                <span class="comment">// http://httpd.apache.org/docs/2.0/misc/fin_wait_2.html#appendix</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IOException(sm.getString(<span class="string">"inputFilter.maxSwallow"</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// errors are handled higher up.</span></span><br><span class="line">            remaining = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If too many bytes were read, return the amount.</span></span><br><span class="line">    <span class="keyword">return</span> -remaining;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼ŒTomcatåœ¨ç»“æŸè¯·æ±‚æ—¶ï¼Œæœ‰ä¸€ç§Swallowæœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯æŠŠå®¢æˆ·ç«¯å‘ä¸Šæ¥çš„ï¼ŒServletä¸šåŠ¡é€»è¾‘æ²¡æœ‰æ¶ˆè´¹çš„è¯·æ±‚ä½“ç»§ç»­æ¶ˆè´¹æ‰ï¼Œæˆ–è€…ç§°ä¸ºåæ‰ã€‚</p>
<p>å¯ä»¥ä»å­—èŠ‚çº§åˆ«ä¸ŠéªŒè¯ï¼šå®¢æˆ·ç«¯ä¸Šä¼ çš„è¯·æ±‚ä½“å¤§å°ä¸ºContent-Lengthè¡¨ç¤ºçš„1048756å­—èŠ‚ï¼š</p>
<p><img src="/img/tomcat/remaining-1.png" alt=""></p>
<p>å½“æˆ‘çš„Servletæ²¡æœ‰ä»»ä½•è¯»å–request.inputStreamçš„æ“ä½œæ—¶ï¼ŒTomcatç»“æŸè¯·æ±‚çš„remainingçš„å¤§å°ç­‰äº1048756ï¼Œä¹Ÿå°±æ˜¯å®Œæ•´çš„è¯·æ±‚ä½“å¤§å°ï¼š</p>
<p><img src="/img/tomcat/remaining-2.png" alt=""></p>
<p>å½“æˆ‘çš„Servletç¨‹åºè¯»å–å…¨éƒ¨çš„è¾“å…¥æµæ—¶ï¼ŒTomcatçš„ç»“æŸè¯·æ±‚æµç¨‹ä¸­remaining=0ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸ä¼šå»æ‰§è¡Œswallowçš„æµç¨‹äº†ï¼š</p>
<p><img src="/img/tomcat/remaining-3.png" alt=""></p>
<p>åŒæ—¶é€šè¿‡ä»£ç çœ‹å‡ºï¼ŒTomcatä¹Ÿä¸æ˜¯å®¢æˆ·ç«¯å‘å¤šå°‘å®ƒå°±åå¤šå°‘ï¼Œè€Œæ˜¯æœ‰ä¸€ä¸ªå˜é‡<code>maxSwallowSize</code>æ§åˆ¶ï¼Œå¦‚æœTomcatåçš„å­—èŠ‚å¤§äºè¿™ä¸ªå˜é‡ï¼Œåˆ™ä¼šæŠ›å‡ºIOExceptionã€‚</p>
<p>è¿™ä¸ª<code>maxSwallowSize</code>çš„åˆå§‹å€¼ä¹Ÿå®šä¹‰åœ¨<code>org.apache.coyote.http11.AbstractHttp11Protocol</code>ä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é»˜è®¤å€¼æ˜¯2M</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> maxSwallowSize = <span class="number">2</span> * <span class="number">1024</span> * <span class="number">1024</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMaxSwallowSize</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> maxSwallowSize; &#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMaxSwallowSize</span><span class="params">(<span class="keyword">int</span> maxSwallowSize)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.maxSwallowSize = maxSwallowSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>maxSwallowSize</code>çš„é»˜è®¤å€¼æ˜¯2Mï¼Œæ‰€ä»¥å¦‚æœè¯·æ±‚ä½“å¤§äº2Mï¼ŒTomcatä¸ä¼šç»§ç»­æ¶ˆè´¹ï¼Œè€Œæ˜¯æŠ›å‡ºå¼‚å¸¸å¹¶å…³é—­è¿æ¥ã€‚Tomcatå®˜ç½‘ä¸Šå…³äºè¿™ä¸ªé…ç½®é¡¹çš„æè¿°ï¼š</p>
<p><img src="/img/tomcat/max-swallow-size.png" alt=""></p>
<p>çœ‹åˆ°è¿™ä¸ªé…ç½®è¿˜æ˜¯éå¸¸æ¿€åŠ¨çš„ï¼Œå› ä¸ºè¿™ä¸ªå’Œå®éªŒæ—¶å‘ç°ä¸Šä¼ 2Mæ–‡ä»¶ä¼šå¤±è´¥çš„åŒäº‹çš„ç°è±¡å»åˆäº†ã€‚æˆ‘è¯•ç€ä¸Šä¼ å¤§äº2Mçš„æ–‡ä»¶ï¼Œçš„ç¡®æµè§ˆå™¨æç¤ºè¿æ¥è¢«ä¸­æ–­ï¼š</p>
<p><img src="/img/tomcat/chrome-err-connection-aborted.png" alt=""></p>
<p>å½“ç„¶ï¼Œè¿™ç§æƒ…å†µä¼šå‘ç”Ÿæ˜¯å› ä¸ºä¸šåŠ¡é€»è¾‘æ²¡æœ‰æ¶ˆè´¹æ‰è¿™ä¸ªä¸Šä¼ çš„æ–‡ä»¶ï¼Œå¦‚æœä¸šåŠ¡é€»è¾‘æ­£å¸¸æ¶ˆè´¹æ‰è¿™ä¸ªæ–‡ä»¶ï¼Œæ˜¯ä¸ä¼šå‘ç”Ÿè¿™ç§å¼‚å¸¸çš„ã€‚</p>
<p>çŸ¥é“äº†Tomcatçš„è¿™ä¸ªé€»è¾‘ï¼Œç°åœ¨çš„é—®é¢˜æ˜¯ï¼Œä¸ºä½•Tomcatè¦å»æ¶ˆè´¹æ‰ä¸šåŠ¡é€»è¾‘éƒ½ä¸ç®¡çš„è¯·æ±‚ä½“å‘¢ï¼Ÿå¯¹äºä¸Šä¼ æ–‡ä»¶è¿™ç§è¯·æ±‚ä½“å¾ˆå¤§çš„åœºæ™¯ï¼Œè¿™ä¸€æ­¥å¯èƒ½æ¶ˆè´¹æ‰ä¸å°‘èµ„æºå’Œæ—¶é—´ã€‚</p>
<p>ç›®å‰çš„æ¨è®ºæ˜¯ï¼šè™½ç„¶TCPæ˜¯å…¨åŒå·¥çš„ï¼Œä¹Ÿå°±æ˜¯åœ¨æœåŠ¡ç«¯æ²¡æœ‰è¯»å–å®¢æˆ·ç«¯å‘æ¥çš„æ¶ˆæ¯æ—¶ï¼Œä¹Ÿä¾ç„¶å¯ä»¥ç»™å®¢æˆ·ç«¯å‘é€å“åº”ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰æ¥æ”¶å®Œå®¢æˆ·ç«¯å‘æ¥çš„æ¶ˆæ¯å°±å…³é—­è¿æ¥ï¼Œå®¢æˆ·ç«¯æ˜¯ä¼šæŠ¥é”™çš„ï¼ˆè¿æ¥è¢«ä¸­æ–­ï¼‰ï¼Œæ‰€ä»¥Tomcatä¸ºäº†ä¿è¯å®¢æˆ·ç«¯ä¸æŠ¥é”™æ‰€ä»¥å°è¯•è¯»å–å‰©ä½™çš„è¯·æ±‚ä½“ï¼Œä½†æ˜¯å‡ºäºèµ„æºè€ƒè™‘ï¼Œé™åˆ¶äº†æœ€å¤§è¯»å–çš„å­—èŠ‚æ•°é»˜è®¤ä¸º2Mã€‚å¯¹äºå¤§éƒ¨åˆ†éæ–‡ä»¶ä¸Šä¼ è¯·æ±‚ï¼Œè¿™ä¸ªå¤§å°ä¹Ÿè¶³å¤Ÿäº†ã€‚</p>
<p>åŒæ—¶æ³¨æ„ä¸‹ä¸Šé¢è´´å‡ºçš„ä»£ç ä¸­æœ‰è¿™ä¹ˆä¸€æ®µæ³¨é‡Šï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// Note: We do not fail early so the client has a chance to</span><br><span class="line">// read the response before the connection is closed. See:</span><br><span class="line">// http://httpd.apache.org/docs/2.0/misc/fin_wait_2.html#appendix</span><br></pre></td></tr></table></figure>
<p>ä¸»è¦æ˜¯ä¸€æ®µRoy Fieldingçš„å…³äºä¸ºä»€ä¹ˆHTTPéœ€è¦æ‹–å»¶å…³é—­ï¼ˆlingeringï¼‰åŠŸèƒ½ï¼ŒRoy Fieldingæ˜¯HTTP/1.1çš„ä½œè€…ä¹‹ä¸€ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Below is a message from Roy Fielding, one of the authors of HTTP/1.1.</span><br><span class="line"></span><br><span class="line">Why the lingering close functionality is necessary with HTTP</span><br><span class="line">The need for a server to linger on a socket after a close is noted a couple times in the HTTP specs, but not explained. This explanation is based on discussions between myself, Henrik Frystyk, Robert S. Thau, Dave Raggett, and John C. Mallery in the hallways of MIT while I was at W3C.</span><br><span class="line"></span><br><span class="line">If a server closes the input side of the connection while the client is sending data (or is planning to send data), then the server&apos;s TCP stack will signal an RST (reset) back to the client. Upon receipt of the RST, the client will flush its own incoming TCP buffer back to the un-ACKed packet indicated by the RST packet argument. If the server has sent a message, usually an error response, to the client just before the close, and the client receives the RST packet before its application code has read the error message from its incoming TCP buffer and before the server has received the ACK sent by the client upon receipt of that buffer, then the RST will flush the error message before the client application has a chance to see it. The result is that the client is left thinking that the connection failed for no apparent reason.</span><br><span class="line"></span><br><span class="line">There are two conditions under which this is likely to occur:</span><br><span class="line"></span><br><span class="line">sending POST or PUT data without proper authorization</span><br><span class="line">sending multiple requests before each response (pipelining) and one of the middle requests resulting in an error or other break-the-connection result.</span><br><span class="line">The solution in all cases is to send the response, close only the write half of the connection (what shutdown is supposed to do), and continue reading on the socket until it is either closed by the client (signifying it has finally read the response) or a timeout occurs. That is what the kernel is supposed to do if SO_LINGER is set. Unfortunately, SO_LINGER has no effect on some systems; on some other systems, it does not have its own timeout and thus the TCP memory segments just pile-up until the next reboot (planned or not).</span><br><span class="line"></span><br><span class="line">Please note that simply removing the linger code will not solve the problem -- it only moves it to a different and much harder one to detect.</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µè¯´æ˜çš„å¤§è‡´æ„æ€æ˜¯ï¼š</p>
<p>å¦‚æœæœåŠ¡ç«¯è¦å…³é—­ä¸€ä¸ªæ­£åœ¨å‘é€æˆ–è€…æ­£æ‰“ç®—å‘é€æ•°æ®çš„å®¢æˆ·ç«¯è¿æ¥ï¼ŒTCPæ ˆä¼šå‘å‡ºä¸€ä¸ªRSTï¼ˆResetï¼‰åŒ…ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä¸€æ—¦æ”¶åˆ°RSTåŒ…ï¼Œåˆ™ä¼šæ ¹æ®RSTåŒ…ä¸­çš„ä¿¡æ¯é‡ç½®å…¶æ¥æ”¶ç¼“å†²åŒºçš„æŠ¥æ–‡ä¸ºun-ACKedã€‚å¦‚æœæœåŠ¡ç«¯å‘é€äº†å“åº”æ•°æ®ç»™å®¢æˆ·ç«¯ï¼Œä½†æ˜¯åœ¨å®¢æˆ·ç«¯ä»£ç è¯»å–è¿™ä¸ªå“åº”ä¿¡æ¯å‰æ”¶åˆ°äº†RSTæŠ¥æ–‡ï¼Œé‚£ä¹ˆè¿™ä¸ªRSTæŠ¥æ–‡ä¼šåœ¨å®¢æˆ·ç«¯ä»£ç è¯»å–è¿™ä¸ªå“åº”ä¿¡æ¯å‰åˆ·æ‰è¿™ä¸ªæœåŠ¡ç«¯å‘æ¥çš„å“åº”ä¿¡æ¯ï¼Œå¯¼è‡´å®¢æˆ·ç«¯ä»£ç å†ä¹Ÿæ— æ³•è¯»å–åˆ°è¿™ä¸ªå“åº”ã€‚ç»“æœå°±æ˜¯å®¢æˆ·ç«¯è®¤ä¸ºè¿æ¥ä¸æ˜ä¸ç™½çš„å¤±è´¥äº†ã€‚</p>
<p>è§£å†³æ–¹æ³•å°±æ˜¯æœåŠ¡ç«¯å‘é€äº†å“åº”åï¼Œåªå…³é—­è¿æ¥çš„å†™éƒ¨åˆ†ï¼ˆshutdownå°±æ˜¯è¿™ä¸ªåŠŸèƒ½ï¼‰ï¼Œç„¶åç»§ç»­è¯»å–å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®ï¼Œç›´åˆ°å®ƒä¹Ÿè¢«å®¢æˆ·ç«¯å…³é—­äº†ï¼Œæˆ–è€…æ˜¯è¿æ¥è¶…æ—¶äº†ã€‚å†…æ ¸çš„SO_LINGERæ ‡å¿—ä½å°±æ˜¯è¿™ä¸ªæ•ˆæœï¼Œä½†æ˜¯ä¸å¹¸çš„æ˜¯ä¸æ˜¯æ‰€æœ‰ç³»ç»Ÿéƒ½æœ‰æ•ˆã€‚</p>
<p>RSTåŒ…çš„è¯´æ˜å¯ä»¥å‚è€ƒï¼š<a href="http://blog.csdn.net/eric0318/article/details/51113018" target="_blank" rel="noopener">ç®€å•è¯´è¯´TCP(5) â€” RST</a>ï¼Œè¿™ç¯‡æ–‡ç« æåˆ°çš„å‡ºç°RSTåŒ…çš„åœºæ™¯ï¼Œå°±åŒ…å«ä¸Šé¢æè¿°çš„åœºæ™¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">4. å½“recv bufferè¿˜æœ‰æ•°æ®æ—¶åº”ç”¨ç¨‹åºå…³é—­è¿æ¥ </span><br><span class="line">Aã€Bå»ºç«‹è¿æ¥åï¼ŒAå‘é€5000å­—èŠ‚çš„æ•°æ®ç»™Bï¼Œä½†æ˜¯Båªè¯»äº†4096å­—èŠ‚ï¼Œä¹‹åå°±è°ƒç”¨closesocket()ï¼Œæ­¤æ—¶ï¼ŒBä¼šå‘Aå‘é€ä¸€ä¸ªRSTåŒ…ã€‚</span><br></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol>
<li>TCPçš„æµé‡æ§åˆ¶å¯ä»¥ä¿éšœå‘é€æ–¹çš„æŠ¥æ–‡ä¸ä¼šæ·¹æ²¡æ¥æ”¶æ–¹ï¼Œå½“æ¥æ”¶æ–¹çš„æ¥æ”¶çª—å£å¤§å°ä¸º0æ—¶ï¼Œå‘é€æ–¹å°±ä¸ä¼šç»§ç»­å‘é€äº†</li>
<li>Tomcatåœ¨è°ƒç”¨Servletå¤„ç†è¯·æ±‚å‰ï¼Œä¼šå¤„ç†HTTPè¯·æ±‚ä¸­çš„å¤´éƒ¨ä¿¡æ¯ï¼Œä¼šè¯»å–æ•°æ®ï¼Œæœ€å¤šä¼šè¯»å–<code>maxHttpHeaderSize</code>ï¼ˆé»˜è®¤8kï¼‰é•¿åº¦çš„å†…å®¹</li>
<li>Tomcatåœ¨è°ƒç”¨Servletå¤„ç†è¯·æ±‚åï¼Œä¼šåˆ¤æ–­æ˜¯å¦æœ‰å‰©ä½™çš„æœªæ¶ˆè´¹çš„è¯·æ±‚ä½“æ•°æ®ï¼Œå¦‚æœæœ‰åˆ™æ¶ˆè´¹æ‰ï¼Œæœ€å¤šæ¶ˆè´¹<code>maxSwallowSize</code>ï¼ˆé»˜è®¤2Mï¼‰é•¿åº¦çš„æ•°æ®ï¼Œå¦‚æœç”¨æˆ·å‘é€çš„è¯·æ±‚ä½“å¤§äº<code>maxSwallowSize</code>ï¼Œåˆ™å¼ºè¡Œå…³é—­è¿æ¥ã€‚</li>
</ol>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a href="http://blog.csdn.net/yechaodechuntian/article/details/25429143" target="_blank" rel="noopener">TCPçš„æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶ - CSDNåšå®¢</a></li>
<li><a href="https://www.zhihu.com/question/32255109" target="_blank" rel="noopener">TCPåè®®çš„æ»‘åŠ¨çª—å£å…·ä½“æ˜¯æ€æ ·æ§åˆ¶æµé‡çš„ï¼Ÿ - çŸ¥ä¹</a></li>
<li><a href="http://blog.csdn.net/witsmakemen/article/details/27319951" target="_blank" rel="noopener">TCPçš„æ¥æ”¶ç¼“å†²åŒºæ»¡äº†ï¼Œæ”¶åˆ°æ•°æ®åä¼šå‘å‘é€æ–¹å‘é€ACKå—ï¼Ÿè¯¥æ€ä¹ˆè§£å†³ - CSDNåšå®¢</a></li>
<li><a href="https://tomcat.apache.org/tomcat-7.0-doc/config/http.html" target="_blank" rel="noopener">Apache Tomcat 7 Configuration Reference (7.0.84) - The HTTP Connector</a></li>
</ul>
</div><div class="reward"><hr><div class="text">å¦‚æœè§‰å¾—æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œå°±æ‰“èµæ¯å’–å•¡é’±å‘—ğŸ˜Š</div><img src="/img/reward/weixin.png"><img src="/img/reward/alipay.png"></div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://mushanshitiancai.github.io/2018/02/13/java/language/tomcat/Tomcatç¬”è®°-ä¸Šä¼ çš„è¯·æ±‚ä½“Tomcatæ˜¯å¦ä¼šå…¨éƒ¨æ¶ˆè´¹æ‰ï¼Ÿ/" data-id="cjkb9otaw00qmb3319dfabfyh" class="article-share-link">åˆ†äº«</a><div class="tags"><a href="/tags/java/">java</a><a href="/tags/tomcat/">tomcat</a></div><div class="post-nav"><a href="/2018/02/27/tools/curlç¬”è®°-åŸºæœ¬ä½¿ç”¨/" class="pre">CURLç¬”è®°-åŸºæœ¬ä½¿ç”¨</a><a href="/2018/02/13/java/language/tomcat/Tomcatç¬”è®°-IDEä¸­è°ƒè¯•Tomcatæºç /" class="next">Tomcatç¬”è®°-IDEä¸­è°ƒè¯•Tomcatæºç </a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">é˜…è¯»è¯„è®º ã€Œè¯·ç¡®ä¿ disqus.com å¯ä»¥æ­£å¸¸åŠ è½½ã€</button></div><script>var disqus_shortname = 'mushan';
var disqus_identifier = '2018/02/13/java/language/tomcat/Tomcatç¬”è®°-ä¸Šä¼ çš„è¯·æ±‚ä½“Tomcatæ˜¯å¦ä¼šå…¨éƒ¨æ¶ˆè´¹æ‰ï¼Ÿ/';
var disqus_title = 'Tomcatç¬”è®°-ä¸Šä¼ çš„è¯·æ±‚ä½“Tomcatæ˜¯å¦ä¼šå…¨éƒ¨æ¶ˆè´¹æ‰ï¼Ÿ';
var disqus_url = 'http://mushanshitiancai.github.io/2018/02/13/java/language/tomcat/Tomcatç¬”è®°-ä¸Šä¼ çš„è¯·æ±‚ä½“Tomcatæ˜¯å¦ä¼šå…¨éƒ¨æ¶ˆè´¹æ‰ï¼Ÿ/';
$('.btn_click_load').click(function() {
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  $('.btn_click_load').css('display','none');
});
$.ajax({
  url: 'https://disqus.com/favicon.ico',
  timeout: 3000,
  type: 'GET',
  success: (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    $('.btn_click_load').css('display','none');
  })(),
  error: function() {
    $('.btn_click_load').css('display','block');
  }
});</script><script id="dsq-count-scr" src="//mushan.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://mushanshitiancai.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> åˆ†ç±»</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Java/Groovy/">Groovy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/JDKæºç é˜…è¯»/">JDKæºç é˜…è¯»</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/Spring/">Spring</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/æŒæ¡Java/">æŒæ¡Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/è°ƒè¯•/">è°ƒè¯•</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/TypeScript/">TypeScript</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MongoDB/">MongoDB</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/RabbitMQ/">RabbitMQ</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tomcat/">Tomcat</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/electron/">electron</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/è‡ªåŠ¨åŒ–/">è‡ªåŠ¨åŒ–</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/è‡ªå·±åŠ¨æ‰‹å†™æ“ä½œç³»ç»Ÿ/">è‡ªå·±åŠ¨æ‰‹å†™æ“ä½œç³»ç»Ÿ</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> æ ‡ç­¾</i></div><div class="tagcloud"><a href="/tags/php/" style="font-size: 15px;">php</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/log/" style="font-size: 15px;">log</a> <a href="/tags/js/" style="font-size: 15px;">js</a> <a href="/tags/angularjs/" style="font-size: 15px;">angularjs</a> <a href="/tags/db/" style="font-size: 15px;">db</a> <a href="/tags/mongodb/" style="font-size: 15px;">mongodb</a> <a href="/tags/react/" style="font-size: 15px;">react</a> <a href="/tags/mmnote/" style="font-size: 15px;">mmnote</a> <a href="/tags/architecture/" style="font-size: 15px;">architecture</a> <a href="/tags/protocol-buffers/" style="font-size: 15px;">protocol-buffers</a> <a href="/tags/mq/" style="font-size: 15px;">mq</a> <a href="/tags/blog/" style="font-size: 15px;">blog</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/tools/" style="font-size: 15px;">tools</a> <a href="/tags/emacs/" style="font-size: 15px;">emacs</a> <a href="/tags/ç®¡ç†åå°/" style="font-size: 15px;">ç®¡ç†åå°</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/os/" style="font-size: 15px;">os</a> <a href="/tags/shell/" style="font-size: 15px;">shell</a> <a href="/tags/vagrant/" style="font-size: 15px;">vagrant</a> <a href="/tags/tmux/" style="font-size: 15px;">tmux</a> <a href="/tags/mac/" style="font-size: 15px;">mac</a> <a href="/tags/automation/" style="font-size: 15px;">automation</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/http/" style="font-size: 15px;">http</a> <a href="/tags/nginx/" style="font-size: 15px;">nginx</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/work/" style="font-size: 15px;">work</a> <a href="/tags/bochs/" style="font-size: 15px;">bochs</a> <a href="/tags/project/" style="font-size: 15px;">project</a> <a href="/tags/test/" style="font-size: 15px;">test</a> <a href="/tags/software/" style="font-size: 15px;">software</a> <a href="/tags/web/" style="font-size: 15px;">web</a> <a href="/tags/ffmpeg/" style="font-size: 15px;">ffmpeg</a> <a href="/tags/gm/" style="font-size: 15px;">gm</a> <a href="/tags/graphicsmagick/" style="font-size: 15px;">graphicsmagick</a> <a href="/tags/wireshark/" style="font-size: 15px;">wireshark</a> <a href="/tags/curl/" style="font-size: 15px;">curl</a> <a href="/tags/vscode/" style="font-size: 15px;">vscode</a> <a href="/tags/javafx/" style="font-size: 15px;">javafx</a> <a href="/tags/jvm/" style="font-size: 15px;">jvm</a> <a href="/tags/guava/" style="font-size: 15px;">guava</a> <a href="/tags/junit/" style="font-size: 15px;">junit</a> <a href="/tags/groovy/" style="font-size: 15px;">groovy</a> <a href="/tags/idea/" style="font-size: 15px;">idea</a> <a href="/tags/tomcat/" style="font-size: 15px;">tomcat</a> <a href="/tags/maven/" style="font-size: 15px;">maven</a> <a href="/tags/doclet/" style="font-size: 15px;">doclet</a> <a href="/tags/log4j/" style="font-size: 15px;">log4j</a> <a href="/tags/dubbo/" style="font-size: 15px;">dubbo</a> <a href="/tags/servlet/" style="font-size: 15px;">servlet</a> <a href="/tags/spring/" style="font-size: 15px;">spring</a> <a href="/tags/css/" style="font-size: 15px;">css</a> <a href="/tags/electron/" style="font-size: 15px;">electron</a> <a href="/tags/javascript/" style="font-size: 15px;">javascript</a> <a href="/tags/jquery/" style="font-size: 15px;">jquery</a> <a href="/tags/nodejs/" style="font-size: 15px;">nodejs</a> <a href="/tags/typescript/" style="font-size: 15px;">typescript</a> <a href="/tags/webpack/" style="font-size: 15px;">webpack</a> <a href="/tags/ts/" style="font-size: 15px;">ts</a> <a href="/tags/gulp/" style="font-size: 15px;">gulp</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> æœ€è¿‘æ–‡ç« </i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/08/01/java/language/JDKæºç é˜…è¯»-InterruptibleChannelä¸å¯ä¸­æ–­IO/">JDKæºç é˜…è¯»-InterruptibleChannelä¸å¯ä¸­æ–­IO</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/28/java/language/Javaæ—¥å¿—-Log4jå®ç°è¿è¡Œæ—¶ä¿®æ”¹æ—¥å¿—çº§åˆ«/">Javaæ—¥å¿—-Log4jå®ç°è¿è¡Œæ—¶ä¿®æ”¹æ—¥å¿—çº§åˆ«</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/28/java/language/Javaæ—¥å¿—-Log4jæºç åˆ†æ/">Javaæ—¥å¿—-Log4jæºç åˆ†æ</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/22/java/language/Javaæ—¥å¿—-SLF4Jä½¿ç”¨ä¸æºç åˆ†æ/">Javaæ—¥å¿—-SLF4Jä½¿ç”¨ä¸æºç åˆ†æ</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/11/os/è‡ªå·±åŠ¨æ‰‹å†™æ“ä½œç³»ç»Ÿ-è®¡ç®—æœºé€šç”µä¹‹åçš„æ“ä½œ/">è‡ªå·±åŠ¨æ‰‹å†™æ“ä½œç³»ç»Ÿ-è®¡ç®—æœºé€šç”µä¹‹åçš„æ“ä½œ</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/11/os/Bochså­¦ä¹ -å®‰è£…é…ç½®ç¯‡/">Bochså­¦ä¹ -å®‰è£…é…ç½®ç¯‡</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/18/java/language/Javaå¦‚ä½•ä¿è¯æ–‡ä»¶è½ç›˜ï¼Ÿ/">Javaå¦‚ä½•ä¿è¯æ–‡ä»¶è½ç›˜ï¼Ÿ</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/17/linux/Linux-UNIXç¼–ç¨‹å¦‚ä½•ä¿è¯æ–‡ä»¶è½ç›˜/">Linux/UNIXç¼–ç¨‹å¦‚ä½•ä¿è¯æ–‡ä»¶è½ç›˜</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/07/db/MongoDBéå†æ–¹å¼å¯¹æ¯”/">MongoDBéå†æ–¹å¼å¯¹æ¯”</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/04/java/language/JDKæºç é˜…è¯»-RandomAccessFile/">JDKæºç é˜…è¯»-RandomAccessFile</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> æœ€è¿‘è¯„è®º</i></div><script type="text/javascript" src="//mushan.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> å‹æƒ…é“¾æ¥</i></div><ul></ul><a href="http://anotom.com/" title="é‘«å“¥çš„åšå®¢" target="_blank">é‘«å“¥çš„åšå®¢</a><ul></ul><a href="https://www.caylor.cc/" title="ä¹å“¥çš„åšå®¢" target="_blank">ä¹å“¥çš„åšå®¢</a><ul></ul><a href="http://zach41.github.io/" title="å°ç¾çš„åšå®¢" target="_blank">å°ç¾çš„åšå®¢</a><ul></ul><a href="http://blog.csdn.net/sinat_25127047" title="ç€šæ–‡çš„åšå®¢" target="_blank">ç€šæ–‡çš„åšå®¢</a><ul></ul><a href="http://blog.csdn.net/xiaohangblog?viewmode=contents)" title="å°æ­çš„åšå®¢" target="_blank">å°æ­çš„åšå®¢</a><ul></ul><a href="http://bettercuicui.github.io/" title="å¤ä¾¯çš„åšå®¢" target="_blank">å¤ä¾¯çš„åšå®¢</a><ul></ul><a href="http://damye.github.io/" title="ç¬¦å°§çš„åšå®¢" target="_blank">ç¬¦å°§çš„åšå®¢</a><ul></ul><a href="http://blog.shrp.me/" title="å°šå¼Ÿçš„åšå®¢" target="_blank">å°šå¼Ÿçš„åšå®¢</a><ul></ul><a href="http://imethan.cn" title="åº”é”‹çš„åšå®¢" target="_blank">åº”é”‹çš„åšå®¢</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2018 <a href="/." rel="nofollow">æœ¨æ‰çš„åšå®¢.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>